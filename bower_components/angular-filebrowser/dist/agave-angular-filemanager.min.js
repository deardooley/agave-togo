!function(window,angular,$){"use strict";angular.module("FileManagerApp",["pascalprecht.translate","ngCookies","ngFileUpload","checklist-model","oc.lazyLoad","ui.bootstrap","angularMoment","ui.router","ngSanitize","ngStorage","agave.sdk","ngclipboard"]);$(window.document).on("shown.bs.modal",".modal",function(){setTimeout(function(){$("[autofocus]",this).focus()}.bind(this),100)}),$(window.document).on("click",function(){$("#context-menu").hide()}),$(window.document).on("contextmenu",".main-navigation .table-files tr, .iconset a.thumbnail",function(e){var posX=$(this).position().left,posY=$(this).position().top;$("#context-menu").hide().css({left:posX+100,top:posY-200}).show(),e.preventDefault()})}(window,angular,jQuery),function(window,angular,$){"use strict";angular.module("FileManagerApp").controller("FileManagerCtrl",["$scope","$rootScope","$translate","$cookies","$filter","$ocLazyLoad","fileManagerConfig","fileItem","fileNavigator","fileUploader","SystemsController",function($scope,$rootScope,$translate,$cookies,$filter,$ocLazyLoad,fileManagerConfig,fileItem,FileNavigator,FileUploader,SystemsController){$scope.config=fileManagerConfig,$scope.appName=fileManagerConfig.appName,$scope.modes=["Javascript","Shell","XML","Markdown","CLike","Python"],$scope.cmMode="",$scope.preserveDirectoryStructure=!1,$scope.cmOptions={lineWrapping:!0,lineNumbers:!0,matchBrackets:!0,styleActiveLine:!1,theme:"solarized",mode:"shell",onLoad:function(_cm){$scope.modeChanged=function(){$scope.cmMode=this.cmMode,_cm.setOption("mode",$scope.cmMode.toLowerCase()),$ocLazyLoad.load(["/bower_components/codemirror/mode/"+$scope.cmMode+"/"+$scope.cmMode+".js"])}}},$scope.reverse=!1,$scope.predicate=["model.type","model.name"],$scope.order=function(predicate){$scope.reverse=$scope.predicate[1]===predicate&&!$scope.reverse,$scope.predicate[1]=predicate},$scope.system="",$scope.path="",$scope.query="",$scope.temp=new fileItem(null,null,$scope.system),$scope.fileNavigator=new FileNavigator($scope.system,$scope.path),$scope.fileUploader=FileUploader,$scope.uploadFileList=[],$scope.viewTemplate=$cookies.viewTemplate||"main-table.html",$scope.setTemplate=function(name){$scope.viewTemplate=$cookies.viewTemplate=name},$scope.changeLanguage=function(locale){return locale?$translate.use($cookies.language=locale):void $translate.use($cookies.language||fileManagerConfig.defaultLang)},$scope.touch=function(item){item=item instanceof fileItem?item:new fileItem(null,null,$scope.system),item.revert&&item.revert(),$scope.temp=item},$scope.smartClick=function(item){if(item.isFolder())return $scope.fileNavigator.folderClick(item);if($scope.config.allowedActions.agaveUpload===!0)item.isImage(),$scope.fileNavigator.requesting=!0,item.getContent().then(function(response){$rootScope.uploadFileContent=response.result,$scope.fileNavigator.requesting=!1},function(response){var errorMsg=response.result&&response.result.error||$translate.instant("error_uploading_files");$scope.temp.error=errorMsg});else{if($scope.config.allowedActions.agaveSelect!==!0)return item.preview(),$scope.temp=item,$scope.modal("preview");$rootScope.uploadFileContent="agave://"+item.model.system.id+item.model.fullPath()}},$scope.modal=function(id,hide){$("#"+id).modal(hide?"hide":"show")},$scope.isInThisPath=function(path){var currentPath=$scope.fileNavigator.currentPath.join("/");return currentPath.indexOf(path)!==-1},$scope.editSave=function(item){item.editSave().then(function(){$scope.modal("preview",!0),$scope.fileNavigator.refresh()})},$scope.changePermissions=function(item){item.changePermissions().then(function(data){$scope.modal("changepermissions",!0)})},$scope.editPermissions=function(item){item.editPermissions(item)},$scope.initCopySystem=function(system){$scope.selectedSystem=""},$scope.copy=function(item){var samePath=item.tempModel.path.join()===item.model.path.join();return samePath&&$scope.fileNavigator.fileNameExists(item.tempModel.name)?(item.error=$translate.instant("error_invalid_filename"),!1):void item.copy().then(function(){$scope.fileNavigator.refresh(),$scope.modal("copy",!0)})},$scope.compress=function(item){item.compress().then(function(){return $scope.fileNavigator.refresh(),$scope.config.compressAsync?void(item.asyncSuccess=!0):$scope.modal("compress",!0)},function(){item.asyncSuccess=!1})},$scope.extract=function(item){item.extract().then(function(){return $scope.fileNavigator.refresh(),$scope.config.extractAsync?void(item.asyncSuccess=!0):$scope.modal("extract",!0)},function(){item.asyncSuccess=!1})},$scope.remove=function(item){item.remove().then(function(){$scope.fileNavigator.refresh(),$scope.modal("delete",!0)})},$scope.rename=function(item){var samePath=item.tempModel.path.join()===item.model.path.join();return samePath&&$scope.fileNavigator.fileNameExists(item.tempModel.name)?(item.error=$translate.instant("error_invalid_filename"),!1):void item.rename().then(function(){$scope.fileNavigator.refresh(),$scope.modal("rename",!0)})},$scope.timeItem="",$scope.timeItems=["seconds","minutes","hours","days"],$scope.selectTime=function(time){$scope.timeItem=time},$scope.createPostit=function(item){item.createPostit($scope.timeItem).then(function(data){},function(data){})},$scope.createFolder=function(item){var name=item.tempModel.name&&item.tempModel.name.trim();return item.tempModel.type="dir",item.tempModel.path=$scope.fileNavigator.currentPath,!name||$scope.fileNavigator.fileNameExists(name)?($scope.temp.error=$translate.instant("error_invalid_filename"),!1):void item.createFolder().then(function(){$scope.fileNavigator.refresh(),$scope.modal("newfolder",!0)})},$scope.uniqueFiles=function(array){for(var a=array.concat(),i=0;i<a.length;++i)for(var j=i+1;j<a.length;++j)a[i].name===a[j].name&&a.splice(j--,1);return a},$scope.addForUpload=function($files){$scope.uploadFileList=$scope.uniqueFiles($scope.uploadFileList.concat($files)),$scope.modal("uploadfile")},$scope.removeFromUpload=function(index){$scope.uploadFileList.splice(index,1)},$scope.uploadFiles=function(){$scope.fileUploader.upload($scope.uploadFileList,$scope.system,$scope.fileNavigator.currentPath,$scope.preserveDirectoryStructure).then(function(){$scope.fileNavigator.refresh(),$scope.uploadFileList=[],$scope.modal("uploadfile",!0)},function(data){var errorMsg=data.result&&data.result.error||$translate.instant("error_uploading_files");$scope.temp.error=errorMsg})},$scope.checkAllFiles=function(checkAll){checkAll?$scope.fileNavigator.fileListSelected=$scope.fileNavigator.fileList.filter(function(file){if("dir"!==file.model.type)return file}):$scope.fileNavigator.fileListSelected=[]},$scope.download=function(item){item.download().then(function(data){$scope.modal("preview",!0)},function(data){var errorMsg=data.result&&data.result.error||$translate.instant("error_downloading_files");$scope.temp.error=errorMsg})},$scope.downloadFiles=function(fileListSelected){$scope.fileUploader.downloadSelected(fileListSelected).then(function(){$scope.fileNavigator.refresh(),$scope.modal("uploadfile",!0)},function(data){var errorMsg=data.result&&data.result.error||$translate.instant("error_downloading_files");$scope.temp.error=errorMsg})},$scope.deleteFiles=function(fileListSelected){$scope.fileUploader.deleteSelected(fileListSelected).then(function(){$scope.fileNavigator.refresh(),$scope.modal("uploadfile",!0)},function(data){var errorMsg=data.result&&data.result.error||$translate.instant("error_deleting_files");$scope.temp.error=errorMsg})},$scope.getQueryParam=function(param){var found;return window.location.search.substr(1).split("&").forEach(function(item){if(param===item.split("=")[0])return found=item.split("=")[1],!1}),found},$scope.selectItem=function(item){$rootScope.uploadFileContent="agave://"+item.model.system.id+item.model.fullPath()},$scope.changeLanguage($scope.getQueryParam("lang")),$scope.isWindows="Windows"===$scope.getQueryParam("server"),$scope.$parent.$parent.system&&$scope.fileNavigator.refresh(),$rootScope.$on("af:directory-change",function(event,systemId,newPath){$scope.config.allowedActions.agaveUpload===!1&&$scope.config.allowedActions.agaveSelect===!1&&$scope.$parent.$parent.$state&&newPath&&$scope.$parent.$parent.$state.transitionTo("data-explorer",{systemId:systemId,path:newPath},{location:!0,inherit:!0,relative:$scope.$parent.$parent.$state.$current,notify:!1})}),$scope.$watch("$parent.$parent.system",function(newVal,oldVal){$scope.system=newVal,$scope.fileNavigator=new FileNavigator($scope.system,$scope.$parent.$parent.path),$scope.fileNavigator.refresh()})}])}(window,angular,jQuery),function(angular,$){"use strict";angular.module("FileManagerApp").controller("ModalFileManagerCtrl",["$scope","$rootScope","fileNavigator",function($scope,$rootScope,FileNavigator){$scope.reverse=!1,$scope.predicate=["model.type","model.name"],$scope.order=function(predicate){$scope.reverse=$scope.predicate[1]===predicate&&!$scope.reverse,$scope.predicate[1]=predicate},$rootScope.select=function(item,temp){item.model.root===!0?temp.tempModel.path=item.model.path:temp.tempModel.path=item.model.fullPath().split("/"),$("#selector").modal("hide")},$rootScope.openNavigator=function(item,system){"undefined"!=typeof system?($scope.fileNavigator=new FileNavigator(system,""),item.tempModel.system=system):$scope.fileNavigator=new FileNavigator(item.model.system,item.model.path.slice()),$scope.fileNavigator.refresh(),$("#selector").modal("show")}}])}(angular,jQuery),function(angular){"use strict";var app=angular.module("FileManagerApp");app.directive("angularFilemanager",["$parse","fileManagerConfig",function($parse,fileManagerConfig){return{restrict:"EA",templateUrl:fileManagerConfig.tplPath+"/main.html",scope:{system:"=agaveSystem",upload:"=agaveUpload",select:"=agaveSelect"},link:function(scope,element,attrs){fileManagerConfig.allowedActions.agaveUpload="undefined"!=typeof attrs.agaveUpload,fileManagerConfig.allowedActions.agaveSelect="undefined"!=typeof attrs.agaveSelect}}}]),app.directive("ngFile",["$parse",function($parse){return{restrict:"A",link:function(scope,element,attrs){var model=$parse(attrs.ngFile),modelSetter=model.assign;element.bind("change",function(){scope.$apply(function(){modelSetter(scope,element[0].files)})})}}}]),app.directive("ngRightClick",["$parse",function($parse){return function(scope,element,attrs){var fn=$parse(attrs.ngRightClick);element.bind("contextmenu",function(event){scope.$apply(function(){event.preventDefault(),fn(scope,{$event:event})})})}}]),app.directive("systemSelect",function(SystemsController){return{replace:!0,restrict:"E",scope:{agaveSourceSystem:"=agaveSourceSystem",agaveDestSystem:"=agaveDestSystem",searchFilter:"=searchFilter"},template:'<div class="agave-system-select"><ui-select data-ng-disabled="disabled" ng-model="agaveDestSystem" theme="bootstrap" on-select="setSystem($select.selected)" style="width:100%;"><ui-select-match placeholder="Please select the destination system"><div class="selected-system"><i style="font-size: 1.3em;vertical-align:top;" class="mrs" ng-class="{\'icon icon-cpu pts\': $select.selected.type == \'EXECUTION\', \'fa fa-database ptm\': $select.selected.type == \'STORAGE\'}"></i><span style="display:inline-block; vertical-align: bottom;" class="system-info">{{ $select.selected.name }}</span></div></ui-select-match><ui-select-choices refresh="searchSystems($select.search)" refresh-delay="300" repeat="system.id as system in systems | propertyFilter: {id: $select.search, name: $select.search}"><div class="candidate-profile-link"><i style="font-size: 2em;vertical-align: top;" ng-class="{\'icon icon-cpu pts\': system.type == \'EXECUTION\', \'fa fa-database fa-2x ptm\': system.type == \'STORAGE\'}"></i><span style="display:inline-block" class="system-info">{{ system.name }}<br><em class="small_text">({{system.id}})</em></span></div></ui-select-choices><ui-select-no-choice><div>Select the system where the file item will be copied</div></ui-select-no-choice></ui-select></div>',link:function(scope,element,attrs,model){scope.systems=[],scope.disabled=void 0,scope.setSystem=function(system){scope.agaveDestSystem=system},scope.searchSystems=function(query){scope.disabled=!0;var searchExpression=scope.searchFilter||"";SystemsController.searchSystems("filter=id,name,type,storage&id.like=*"+query+"*&limit=20&"+searchExpression).then(function(data){scope.systems=data.result,scope.disabled=!1},function(err){scope.systems=[],console.log(err),scope.disabled=!1})}}}})}(angular),function(angular){"use strict";angular.module("FileManagerApp").service("AccessControlList",function(){var AccessControlList=function(initValue){if(this.grants={},initValue)if(angular.isObject(initValue)){var pem=this.convertfromAgavePermission(initValue);if(!pem)throw new Error("Invalid permission input data");this.grants[this.username]=pem}else if(angular.isArray(initValue)){var pems=this.convertfromAgavePermissionArray(initValue);if(!pems)throw new Error("Invalid permission input data");this.grants=pems}else{var pem=this.getRwxObjForText(initValue);if(!pem)throw new Error("Invalid permission input data");this.grants[this.username]=pem}};return AccessControlList.prototype.toOctal=function(prepend,append){var props=["owner","group","others"],result=[];for(var i in props){var key=props[i];result[i]=this[key]&&this[key].read&&this.octalValues.read||0,result[i]+=this[key]&&this[key].write&&this.octalValues.write||0,result[i]+=this[key]&&this[key].exec&&this.octalValues.exec||0}return(prepend||"")+result.join("")+(append||"")},AccessControlList.prototype.toCode=function(prepend,append){var props=["owner","group","others"],result=[];for(var i in props){var key=props[i];result[i]=this[key]&&this[key].read&&this.codeValues.read||"-",result[i]+=this[key]&&this[key].write&&this.codeValues.write||"-",result[i]+=this[key]&&this[key].exec&&this.codeValues.exec||"-"}return(prepend||"")+result.join("")+(append||"")},AccessControlList.prototype.toEnumPermissionValue=function(prepend,append){var props=["owner","group","others"],result=[];for(var i in props){var key=props[i];result[i]=this[key]&&this[key].read&&this.codeValues.read||"-",result[i]+=this[key]&&this[key].write&&this.codeValues.write||"-",result[i]+=this[key]&&this[key].exec&&this.codeValues.exec||"-"}return(prepend||"")+result.join("")+(append||"")},AccessControlList.prototype.getRwxObj=function(){return{read:!1,write:!1,exec:!1,recursive:!1}},AccessControlList.prototype.getRwxObjForText=function(str){var str=str.toLowerCase(),rwxObj=this.getRwxObj;return rwxObj.read=/read/.test(str)||/all/.test(str),rwxObj.write=/write/.test(str)||/all/.test(str),rwxObj.execute=/execute/.test(str)||/all/.test(str),rwxObj},AccessControlList.prototype.octalValues={read:4,write:2,exec:1},AccessControlList.prototype.codeValues={read:"r",write:"w",exec:"x"},AccessControlList.prototype.textValues={read:"READ",write:"WRITE",exec:"EXECUTE"},AccessControlList.prototype.convertfromCode=function(str){if(str=(""+str).replace(/\s/g,""),str=10===str.length?str.substr(1):str,/^[-rwx]{9}$/.test(str)){var result=[],vals=str.match(/.{1,3}/g);for(var i in vals){var rwxObj=this.getRwxObj();rwxObj.read=/r/.test(vals[i]),rwxObj.write=/w/.test(vals[i]),rwxObj.exec=/x/.test(vals[i]),result.push(rwxObj)}return{owner:result[0],group:result[1],others:result[2]}}},AccessControlList.prototype.convertfromAgavePermission=function(agavePermission){var pem=agavePermission.permission;return pem.recursive=agavePermission.recursive,pem},AccessControlList.prototype.convertfromAgavePermissionArray=function(agavePermissionArray){var userPems={};for(var i in agavePermissionArray)userPems[i.username]=this.convertfromAgavePermission(i);return userPems},AccessControlList.prototype.convertfromOctal=function(str){if(str=(""+str).replace(/\s/g,""),str=4===str.length?str.substr(1):str,/^[0-7]{3}$/.test(str)){var result=[],vals=str.match(/.{1}/g);for(var i in vals){var rwxObj=this.getRwxObj();rwxObj.read=/[4567]/.test(vals[i]),rwxObj.write=/[2367]/.test(vals[i]),rwxObj.exec=/[1357]/.test(vals[i]),result.push(rwxObj)}return{owner:result[0],group:result[1],others:result[2]}}},AccessControlList})}(angular),function(angular){"use strict";angular.module("FileManagerApp").service("chmod",function(){var Chmod=function(initValue){if(this.owner=this.getRwxObj(),this.group=this.getRwxObj(),this.others=this.getRwxObj(),initValue){var codes=isNaN(initValue)?this.convertfromCode(initValue):this.convertfromOctal(initValue);if(!codes)throw new Error("Invalid chmod input data");this.owner=codes.owner,this.group=codes.group,this.others=codes.others}};return Chmod.prototype.toOctal=function(prepend,append){var props=["owner","group","others"],result=[];for(var i in props){var key=props[i];result[i]=this[key].read&&this.octalValues.read||0,result[i]+=this[key].write&&this.octalValues.write||0,result[i]+=this[key].exec&&this.octalValues.exec||0}return(prepend||"")+result.join("")+(append||"")},Chmod.prototype.toCode=function(prepend,append){var props=["owner","group","others"],result=[];for(var i in props){var key=props[i];result[i]=this[key].read&&this.codeValues.read||"-",result[i]+=this[key].write&&this.codeValues.write||"-",result[i]+=this[key].exec&&this.codeValues.exec||"-"}return(prepend||"")+result.join("")+(append||"")},Chmod.prototype.getRwxObj=function(){return{read:!1,write:!1,exec:!1}},Chmod.prototype.octalValues={read:4,write:2,exec:1},Chmod.prototype.codeValues={read:"r",write:"w",exec:"x"},Chmod.prototype.convertfromCode=function(str){if(str=(""+str).replace(/\s/g,""),str=10===str.length?str.substr(1):str,/^[-rwx]{9}$/.test(str)){var result=[],vals=str.match(/.{1,3}/g);for(var i in vals){var rwxObj=this.getRwxObj();rwxObj.read=/r/.test(vals[i]),rwxObj.write=/w/.test(vals[i]),rwxObj.exec=/x/.test(vals[i]),result.push(rwxObj)}return{owner:result[0],group:result[1],others:result[2]}}},Chmod.prototype.convertfromOctal=function(str){if(str=(""+str).replace(/\s/g,""),str=4===str.length?str.substr(1):str,/^[0-7]{3}$/.test(str)){var result=[],vals=str.match(/.{1}/g);for(var i in vals){var rwxObj=this.getRwxObj();rwxObj.read=/[4567]/.test(vals[i]),rwxObj.write=/[2367]/.test(vals[i]),rwxObj.exec=/[1357]/.test(vals[i]),result.push(rwxObj)}return{owner:result[0],group:result[1],others:result[2]}}},Chmod})}(angular),function(window,angular,$){"use strict";angular.module("FileManagerApp").factory("fileItem",["$http","$q","$translate","$localStorage","$state","$uibModal","$rootScope","fileManagerConfig","AccessControlList","FilesController","FileManagementActionTypeEnum","PostitsController","TransformsController","Configuration","Upload",function($http,$q,$translate,$localStorage,$state,$uibModal,$rootScope,fileManagerConfig,AccessControlList,FilesController,FileManagementActionTypeEnum,PostitsController,TransformsController,Configuration,Upload){var FileItem=function(model,path,system){var rawModel={name:model&&model.name||"",path:path||[],type:model&&model.type||"file",size:model&&parseInt(model.length||0),date:model&&model.lastModified,perms:this.agaveFilePermission(model&&model.permissions),content:model&&model.content||"",recursive:!1,sizeKb:function(){return Math.round(this.size/1024,1)},fullPath:function(){return(this.path.join("/")+"/"+this.name).replace(/^\/\//,"/")},crumbsPath:function(){var fullPath=this.fullPath().split("/");return fullPath},_links:model&&model._links,system:system};this.error="",this.inprocess=!1,this.postit={},this.model=angular.copy(rawModel),this.tempModel=angular.copy(rawModel)};return FileItem.prototype.getRwxObj=function(){return{read:!1,write:!1,execute:!1,recursive:!1}},FileItem.prototype.transformRwxToAgave=function(rwxObj){var result="";return result=rwxObj.read===!0&&rwxObj.write===!0&&rwxObj.execute===!0?"ALL":rwxObj.read===!0&&rwxObj.write===!1&&rwxObj.execute===!1?"READ":rwxObj.read===!1&&rwxObj.write===!0&&rwxObj.execute===!1?"WRITE":rwxObj.read===!1&&rwxObj.write===!1&&rwxObj.execute===!0?"EXECUTE":rwxObj.read===!0&&rwxObj.write===!0&&rwxObj.execute===!1?"READ_WRITE":rwxObj.read===!0&&rwxObj.write===!1&&rwxObj.execute===!0?"READ_EXECUTE":rwxObj.read===!1&&rwxObj.write===!0&&rwxObj.execute===!0?"WRITE_EXECUTE":"NONE"},FileItem.prototype.transformAgaveToRwx=function(agavePermission){var rwxObj=this.getRwxObj();switch(agavePermission){case"ALL":rwxObj.read=!0,rwxObj.write=!0,rwxObj.execute=!0;break;case"READ":rwxObj.read=!0;break;case"WRITE":rwxObj.write=!0;break;case"EXECUTE":rwxObj.execute=!0;break;case"READ_WRITE":rwxObj.read=!0,rwxObj.write=!0;break;case"READ_EXECUTE":rwxObj.read=!0,rwxObj.execute=!0;break;case"WRITE_EXECUTE":rwxObj.write=!0,rwxObj.execute=!0;break;case"EXECUTE":rwxObj.execute=!0}return rwxObj},FileItem.prototype.changePermissions=function(){var self=this,deferred=$q.defer(),newPem=new FilePermissionRequest;return newPem.setUsername(self.tempModel.username),newPem.setPermission(self.tempModel.perms),newPem.setRecursive("file"===self.tempModel.type&&self.tempModel.perms.recursive),self.inprocess=!0,self.error="",FilesController.updateFileItemPermission(newPem,this.model.system.id,self.tempModel.fullPath()).then(function(data){self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_changing_perms"))})["finally"](function(){self.inprocess=!1}),deferred.promise},FileItem.prototype.agaveFilePermission=function(agavePermission){var pems={},username=$localStorage.activeProfile?$localStorage.activeProfile.username:"unknown";return pems[username]=this.transformAgaveToRwx(agavePermission),pems},FileItem.prototype.agaveFilePermissions=function(agavePermission,username){var self=this;self.inprocess=!0;var deferred=$q.defer();FilesController.listFileItemPermissions(self.model.system.id,99999,0,self.model.fullPath()).then(function(data){angular.forEach(data,function(pem){self.model.perms[pem.username]=pem.permission,self.model.recursive=pem.recursive,self.tempModel.recursive=pem.recursive,self.model.perms[pem.username].recursive=pem.recursive,self.tempModel.perms[pem.username]=angular.copy(self.model.perms[pem.username])}),self.inprocess=!1})["catch"](function(data){self.deferredHandler(data,deferred,$translate.instant("error_changing_perms")),self.inprocess=!1})},FileItem.prototype.changePermission=function(pem,username){var self=this,newPem=($q.defer(),new FilePermissionRequest);newPem.setUsername(username),newPem.setPermission(self.transformRwxToAgave(pem)),newPem.setRecursive("file"===self.tempModel.type&&pem.recursive),self.inprocess=!0,self.error="";var path=self.model.path.join("/")+"/"+self.model.name;return FilesController.updateFileItemPermission(newPem,this.model.system.id,path).then(function(data){},function(data){})},FileItem.prototype.changePermissions=function(){var self=this,promises=[];angular.forEach(self.tempModel.perms,function(pem,username){JSON.stringify(self.model.perms[username])!==JSON.stringify(self.tempModel.perms[username])&&promises.push(self.changePermission(pem,username))});var deferred=$q.defer();return $q.all(promises).then(function(data){deferred.resolve(data)},function(data){deferred.reject(data)})},FileItem.prototype.notifications=function(){var self=this;self.inprocess=!0;var deferred=$q.defer();FilesController.listFileItems(self.model.system.id,self.model.fullPath(),1,0).then(function(response){if(0===response.length)$state.go("notifications-manager",{associatedUuid:"",resourceType:"file"});else{var buffer=response[0]._links.metadata.href.split("associationIds%22%3A%22")[1],uuid=buffer.split("%22%7D")[0];$state.go("notifications-manager",{associatedUuid:uuid,resourceType:"file"})}self.inprocess=!1})["catch"](function(response){self.deferredHandler(response,deferred,$translate.instant("error_notifications_files")),self.inprocess=!1})},FileItem.prototype.update=function(){angular.extend(this.model,angular.copy(this.tempModel))},FileItem.prototype.revert=function(){angular.extend(this.tempModel,angular.copy(this.model)),this.error=""},FileItem.prototype.deferredHandler=function(data,deferred,defaultMsg){return data&&"object"==typeof data||(this.error="Bad response from the server, please check the docs"),data.result&&data.result.error&&(this.error=data.result.error),!this.error&&data.error&&(this.error=data.error.message),!this.error&&defaultMsg&&(this.error=defaultMsg),this.error?deferred.reject(data):(this.update(),deferred.resolve(data))},FileItem.prototype.createFolder=function(){var self=this,deferred=$q.defer(),action=new FileMkdirAction;return action.setPath(self.tempModel.name),self.inprocess=!0,self.error="",FilesController.updateInvokeFileItemAction(action,self.tempModel.system.id,self.tempModel.path.join("/")).then(function(data){self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_creating_folder"))})["finally"](function(data){self.inprocess=!1}),deferred.promise},FileItem.prototype.rename=function(){var self=this,deferred=$q.defer(),action=new FileRenameAction;return action.setPath(self.tempModel.name),self.inprocess=!0,self.error="",FilesController.updateInvokeFileItemAction(action,self.model.system.id,self.model.fullPath()).then(function(data){self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_renaming"))})["finally"](function(data){self.inprocess=!1}),deferred.promise},FileItem.prototype.copy=function(){var self=this,deferred=$q.defer(),action=new FileCopyAction;if(self.inprocess=!0,self.error="",self.model.system.id!==self.tempModel.system.id){var urlToIngest=$localStorage.tenant.baseUrl+"files/v2/media/system/"+self.model.system.id+self.model.fullPath();FilesController.importFileItem(urlToIngest,self.tempModel.fullPath(),self.tempModel.system.id).then(function(response){self.deferredHandler(response,deferred)},function(response){var message="";message=response.errorResponse.message?$translate.instant("error_copying")+" - "+response.errorResponse.message:response.errorResponse.fault?$translate.instant("error_copying")+" - "+response.errorResponse.fault.message:$translate.instant("error_copying"),self.deferredHandler(response,deferred,message)})["finally"](function(response){self.inprocess=!1})}else action.setPath(self.tempModel.fullPath()),FilesController.updateInvokeFileItemAction(action,self.model.system.id,self.model.fullPath()).then(function(response){self.deferredHandler(response,deferred)},function(response){var message="";message=response.errorResponse.message?$translate.instant("error_copying")+" - "+response.errorResponse.message:response.errorResponse.fault?$translate.instant("error_copying")+" - "+response.errorResponse.fault.message:$translate.instant("error_copying"),self.deferredHandler(response,deferred,message)})["finally"](function(data){self.inprocess=!1});return deferred.promise},FileItem.prototype.compress=function(){var self=this,deferred=$q.defer();self.inprocess=!0,self.error="";var transformRequest=new TransformRequest;return transformRequest.setNativeFormat("zip-0"),transformRequest.setUrl(self.tempModel._links.self.href),TransformsController.createSyncTransform(transformRequest,ProfilesController.me.username,self.model.fullPath()).then(function(data){self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_compressing"))})["finally"](function(){self.inprocess=!1}),deferred.promise},FileItem.prototype.extract=function(){var self=this,deferred=$q.defer();self.inprocess=!0,self.error="";var transformRequest=new TransformRequest;return transformRequest.setNativeFormat("RAW-0"),transformRequest.setUrl(self.tempModel._links.self.href),TransformsController.createSyncTransform(transformRequest,ProfilesController.me.username,self.model.fullPath()).then(function(data){self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_extracting"))})["finally"](function(){self.inprocess=!1}),deferred.promise},FileItem.prototype.download=function(preview){var self=this,deferred=$q.defer();if(self.inprocess=!0,self.error="",preview===!0)if(self.tempModel.preview&&(self.tempModel.preview={}),self.isImage()){var data={force:"true"},postitIt=new PostItRequest;postitIt.setMaxUses(2),postitIt.setMethod("GET"),postitIt.setUrl([decodeURIComponent(self.model._links.self.href),$.param(data)].join("?")),PostitsController.addPostit(postitIt).then(function(data){self.tempModel.preview={},self.tempModel.preview.isImage=!0,self.tempModel.preview.url=data._links.self.href,self.tempModel.preview.isPreviewable=self.isPreviewable(),self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_getting_content"))})["finally"](function(){self.inprocess=!1})}else{var filePath=self.model._links.self.href;$http({method:"GET",url:filePath,responseType:"arraybuffer",cache:!1,headers:{Authorization:"Bearer "+$localStorage.token.access_token}}).success(function(data){self.tempModel.preview={},self.isPdf()?(self.tempModel.preview.isPdf=!0,self.tempModel.preview.data=URL.createObjectURL(new Blob([data],{type:"application/pdf"}))):(self.tempModel.preview.isText=!0,self.tempModel.preview.data=URL.createObjectURL(new Blob([data]))),self.tempModel.preview.isPreviewable=self.isPreviewable(),self.inprocess=!1,self.deferredHandler(data,deferred,data.message)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_getting_content")),self.inprocess=!1})}else{var data={force:"true"},postitIt=new PostItRequest;postitIt.setMaxUses(2),postitIt.setMethod("GET"),postitIt.setUrl([decodeURIComponent(self.model._links.self.href),$.param(data)].join("?")),PostitsController.addPostit(postitIt).then(function(data){if(self&&"dir"!==self.model.type){"undefined"==typeof self.tempModel.preview&&(self.tempModel.preview={}),self.tempModel.preview.isPdf=self.isPdf(),self.tempModel.preview.isImage=self.isImage(),self.tempModel.preview.isText=self.isText();var link=document.createElement("a");link.setAttribute("download",null),link.setAttribute("href",data._links.self.href),link.style.display="none",document.body.appendChild(link),link.click(),document.body.removeChild(link)}self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_getting_content"))})["finally"](function(){self.inprocess=!1})}return deferred.promise},FileItem.prototype.createPostit=function(timeOption){var self=this,deferred=$q.defer();if("undefined"!=typeof self.postit){var postitIt=new PostItRequest;switch(postitIt.setMaxUses(self.postit.maxUses),postitIt.setMethod("GET"),postitIt.setUrl(decodeURIComponent(self.model._links.self.href)),"undefined"==typeof self.postit.lifetime&&(self.postit.lifetime=2592e3),"undefined"==typeof timeOption&&(timeOption=""),timeOption){case"minutes":postitIt.setLifetime(60*self.postit.lifetime);break;case"hours":postitIt.setLifetime(3600*self.postit.lifetime);break;case"days":postitIt.setLifetime(86400*self.postit.lifetime);break;default:postitIt.setLifetime(self.postit.lifetime)}PostitsController.addPostit(postitIt).then(function(data){self.postit.link=data._links.self.href,self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_getting_content"))})}return deferred.promise},FileItem.prototype.preview=function(){var self=this,deferred=$q.defer();return self.download(!0).then(function(data){self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_displaying"))}),deferred.promise},FileItem.prototype.getContent=function(){var self=this,deferred=$q.defer();return self.inprocess=!0,self.error="",FilesController.getDownloadFileItem(self.tempModel.fullPath(),self.model.system.id,!1).then(function(data){"undefined"==typeof self.tempModel.preview&&(self.tempModel.preview={}),angular.isObject(data)?self.tempModel.content=self.model.content=JSON.stringify(data,null,2):self.tempModel.content=self.model.content=data,self.tempModel.preview.isEdit=!0,
self.deferredHandler({result:self.tempModel.content},deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_getting_content"))})["finally"](function(){self.inprocess=!1}),deferred.promise},FileItem.prototype.remove=function(){var self=this,deferred=$q.defer();return self.inprocess=!0,self.error="",FilesController.deleteFileItem(self.tempModel.fullPath(),self.model.system.id).then(function(data){self.deferredHandler({result:data?data:"Successfully removed object"},deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_deleting"))})["finally"](function(){self.inprocess=!1}),deferred.promise},FileItem.prototype.editSave=function(){var self=this,deferred=$q.defer();self.inprocess=!0;var filePath=Configuration.BASEURI+"files/v2/media/system/"+self.tempModel.system.id+"/"+self.tempModel.path.join("/")+"?naked=true",blob=new Blob([self.tempModel.content],{type:"text/plain"}),file=new File([blob],self.tempModel.name,{type:"text/plain"});return Upload.upload({url:filePath,data:{file:file,fileToUpload:file,append:!1,fileType:"raw"},method:"POST",headers:{"Content-Type":void 0,Authorization:"Bearer "+Configuration.oAuthAccessToken}}).then(function(data){self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_saving"))})["finally"](function(data){self.inprocess=!1}),deferred.promise},FileItem.prototype.fetchPermissions=function(){var self=this,deferred=$q.defer();return self.inprocess=!0,self.error="",FilesController.listFileItemPermissions(this.model.system.id,99999,0,self.tempModel.fullPath()).then(function(data){self.deferredHandler(data,deferred)},function(data){self.deferredHandler(data,deferred,$translate.instant("error_changing_perms"))})["finally"](function(){self.inprocess=!1}),deferred.promise},FileItem.prototype.isFolder=function(){return"dir"===this.model.type},FileItem.prototype.isPreviewable=function(){return!this.isFolder()&&this.model.size<fileManagerConfig.maxPreviewSize&&(this.model.name.indexOf(".")==-1||fileManagerConfig.isPreviewableFilePattern.test(this.model.name))},FileItem.prototype.isEditable=function(){return!this.isFolder()&&this.model.size<fileManagerConfig.maxEditSize&&(this.model.name.indexOf(".")==-1||fileManagerConfig.isEditableFilePattern.test(this.model.name))},FileItem.prototype.isImage=function(){return fileManagerConfig.isImageFilePattern.test(this.model.name)},FileItem.prototype.isCompressible=function(){return this.isFolder()},FileItem.prototype.isExtractable=function(){return!this.isFolder()&&fileManagerConfig.isExtractableFilePattern.test(this.model.name)},FileItem.prototype.isPdf=function(){return!this.isFolder()&&fileManagerConfig.isPdfFilePattern.test(this.model.name)},FileItem.prototype.isText=function(){return!this.isFolder()&&(this.model.name.indexOf(".")==-1||fileManagerConfig.isTextFilePattern.test(this.model.name))},FileItem.prototype.editPermissions=function(resource){$uibModal.open({templateUrl:"/bower_components/angular-filebrowser/src/templates/permissions.html",scope:$rootScope,resolve:{resource:function(){return resource}},controller:["$scope","$modalInstance","resource",function($scope,$modalInstance,resource){$scope.resource=resource,$scope.getRwxObj=function(){return{read:!1,write:!1,execute:!1}},$scope.transformRwxToAgave=function(rwxObj){var result="";return result=rwxObj.read===!0&&rwxObj.write===!0&&rwxObj.execute===!0?"ALL":rwxObj.read!==!0||rwxObj.write!==!1&&"undefined"!=typeof rwxObj.write||rwxObj.execute!==!1&&"undefined"!=typeof rwxObj.execute?rwxObj.read!==!1&&"undefined"!=typeof rwxObj.read||rwxObj.write!==!0||rwxObj.execute!==!1&&"undefined"!=typeof rwxObj.execute?rwxObj.read!==!1&&"undefined"!=typeof rwxObj.read||rwxObj.write!==!1&&"undefined"!=typeof rwxObj.write||rwxObj.execute!==!0?rwxObj.read!==!0||rwxObj.write!==!0||rwxObj.execute!==!1&&"undefined"!=typeof rwxObj.execute?rwxObj.read!==!0||rwxObj.write!==!1&&"undefined"!=typeof rwxObj.write||rwxObj.execute!==!0?rwxObj.read!==!1&&"undefined"!==rwxObj.read||rwxObj.write!==!0||rwxObj.execute!==!0?"NONE":"WRITE_EXECUTE":"READ_EXECUTE":"READ_WRITE":"EXECUTE":"WRITE":"READ"},$scope.transformAgaveToRwx=function(agavePermission){var rwxObj=$scope.getRwxObj();switch(agavePermission){case"ALL":rwxObj.read=!0,rwxObj.write=!0,rwxObj.execute=!0;break;case"READ":rwxObj.read=!0;break;case"WRITE":rwxObj.write=!0;break;case"EXECUTE":rwxObj.execute=!0;break;case"READ_WRITE":rwxObj.read=!0,rwxObj.write=!0;break;case"READ_EXECUTE":rwxObj.read=!0,rwxObj.execute=!0;break;case"WRITE_EXECUTE":rwxObj.write=!0,rwxObj.execute=!0;break;case"EXECUTE":rwxObj.execute=!0}return rwxObj},$scope.refresh=function(){$scope.requesting=!0,FilesController.listFileItemPermissions($scope.resource.tempModel.system.id,99999,0,$scope.resource.tempModel.fullPath()).then(function(response){$scope.model={},$scope.tempModel={},$scope.schema={type:"object",title:"Complex Key Support",properties:{name:{type:"string",title:"Name"},permissions:{title:"permissions by username",type:"array",items:{type:"object",properties:{username:{title:" ",type:"string"},permission:{title:" ",type:"string","enum":["ALL","READ","WRITE","EXECUTE","READ_WRITE","READ_EXECUTE","WRITE_EXECUTE","NONE"]}}}}}},$scope.form=[{key:"permissions",items:[{type:"fieldset",items:[{type:"section",htmlClass:"col-xs-6",items:[{key:"permissions[].username"}]},{type:"section",htmlClass:"col-xs-6",items:["permissions[].permission"]}]}]}];var tempList=[];$scope.tempModel.permissions=[],angular.forEach(response,function(permission){tempList.push({username:permission.username,permission:$scope.transformRwxToAgave(permission.permission)})});var uniqueTempList=_.uniq(tempList,function(permission){return permission.username});$scope.tempModel.permissions=angular.copy(uniqueTempList),$scope.model.permissions=_.clone($scope.tempModel.permissions),$scope.requesting=!1},function(response){$scope.requesting=!1,$modalInstance.dismiss("cancel"),App.alert({message:$translate.instant("error_files_permissions_update")})})},$scope.clearpermissions=function(){$scope.model={},$scope.tempModel={}},$scope.savePermissionChanges=function(){var deletedpermissions=_.difference($scope.model.permissions,$scope.resource.tempModel.permissions);$scope.requesting=!0;var promises=[];angular.forEach(deletedpermissions,function(permission){promises.push(FilesController.deleteClearFileItemPermissions($scope.resource.tempModel.system.id,$scope.resource.tempModel.fullPath()))}),angular.forEach($scope.tempModel.permissions,function(permission){promises.push(FilesController.updateFileItemPermission(permission,$scope.resource.tempModel.system.id,$scope.resource.tempModel.fullPath()))}),$q.all(promises).then(function(response){App.alert({message:$translate.instant("success_files_permissions_update")}),$scope.requesting=!1,$modalInstance.close()},function(response){App.alert({message:$translate.instant("error_files_permissions_update")}),$scope.requesting=!1,$modalInstance.close()})},$scope.cancel=function(){$modalInstance.dismiss("cancel")},$scope.refresh()}]})},FileItem}])}(window,angular,jQuery),function(window,angular,$){"use strict";angular.module("FileManagerApp").factory("item",["$http","$q","$translate","fileManagerConfig","chmod",function($http,$q,$translate,fileManagerConfig,Chmod){var Item=function(model,path){function parseMySQLDate(mysqlDate){var d=(mysqlDate||"").toString().split(/[- :]/);return new Date(d[0],d[1]-1,d[2],d[3],d[4],d[5])}var rawModel={name:model&&model.name||"",path:path||[],type:model&&model.type||"file",size:model&&parseInt(model.size||0),date:parseMySQLDate(model&&model.date),perms:new Chmod(model&&model.rights),content:model&&model.content||"",recursive:!1,sizeKb:function(){return Math.round(this.size/1024,1)},fullPath:function(){return("/"+this.path.join("/")+"/"+this.name).replace(/\/\//,"/")}};this.error="",this.inprocess=!1,this.model=angular.copy(rawModel),this.tempModel=angular.copy(rawModel)};return Item.prototype.update=function(){angular.extend(this.model,angular.copy(this.tempModel))},Item.prototype.revert=function(){angular.extend(this.tempModel,angular.copy(this.model)),this.error=""},Item.prototype.deferredHandler=function(data,deferred,defaultMsg){return data&&"object"==typeof data||(this.error="Bridge response error, please check the docs"),data.result&&data.result.error&&(this.error=data.result.error),!this.error&&data.error&&(this.error=data.error.message),!this.error&&defaultMsg&&(this.error=defaultMsg),this.error?deferred.reject(data):(this.update(),deferred.resolve(data))},Item.prototype.createFolder=function(){var self=this,deferred=$q.defer(),data={params:{mode:"addfolder",path:self.tempModel.path.join("/"),name:self.tempModel.name}};return self.inprocess=!0,self.error="",$http.post(fileManagerConfig.createFolderUrl,data).success(function(data){self.deferredHandler(data,deferred)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_creating_folder"))})["finally"](function(data){self.inprocess=!1}),deferred.promise},Item.prototype.rename=function(){var self=this,deferred=$q.defer(),data={params:{mode:"rename",path:self.model.fullPath(),newPath:self.tempModel.fullPath()}};return self.inprocess=!0,self.error="",$http.post(fileManagerConfig.renameUrl,data).success(function(data){self.deferredHandler(data,deferred)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_renaming"))})["finally"](function(){self.inprocess=!1}),deferred.promise},Item.prototype.copy=function(){var self=this,deferred=$q.defer(),data={params:{mode:"copy",path:self.model.fullPath(),newPath:self.tempModel.fullPath()}};return self.inprocess=!0,self.error="",$http.post(fileManagerConfig.copyUrl,data).success(function(data){self.deferredHandler(data,deferred)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_copying"))})["finally"](function(){self.inprocess=!1}),deferred.promise},Item.prototype.compress=function(){var self=this,deferred=$q.defer(),data={params:{mode:"compress",path:self.model.fullPath(),destination:self.tempModel.fullPath()}};return self.inprocess=!0,self.error="",$http.post(fileManagerConfig.compressUrl,data).success(function(data){self.deferredHandler(data,deferred)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_compressing"))})["finally"](function(){self.inprocess=!1}),deferred.promise},Item.prototype.extract=function(){var self=this,deferred=$q.defer(),data={params:{mode:"extract",path:self.model.fullPath(),sourceFile:self.model.fullPath(),destination:self.tempModel.fullPath()}};return self.inprocess=!0,self.error="",$http.post(fileManagerConfig.extractUrl,data).success(function(data){self.deferredHandler(data,deferred)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_extracting"))})["finally"](function(){self.inprocess=!1}),deferred.promise},Item.prototype.download=function(preview){var self=this,data={mode:"download",preview:preview,path:self.model.fullPath()},url=[fileManagerConfig.downloadFileUrl,$.param(data)].join("?");"dir"!==self.model.type&&window.open(url,"_blank","")},Item.prototype.preview=function(){var self=this;return self.download(!0)},Item.prototype.getContent=function(){var self=this,deferred=$q.defer(),data={params:{mode:"editfile",path:self.tempModel.fullPath()}};return self.inprocess=!0,self.error="",$http.post(fileManagerConfig.getContentUrl,data).success(function(data){self.tempModel.content=self.model.content=data.result,self.deferredHandler(data,deferred)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_getting_content"))})["finally"](function(){self.inprocess=!1}),deferred.promise},Item.prototype.remove=function(){var self=this,deferred=$q.defer(),data={params:{mode:"delete",path:self.tempModel.fullPath()}};return self.inprocess=!0,self.error="",$http.post(fileManagerConfig.removeUrl,data).success(function(data){self.deferredHandler(data,deferred)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_deleting"))})["finally"](function(){self.inprocess=!1}),deferred.promise},Item.prototype.edit=function(){var self=this,deferred=$q.defer(),data={params:{mode:"savefile",content:self.tempModel.content,path:self.tempModel.fullPath()}};return self.inprocess=!0,self.error="",$http.post(fileManagerConfig.editUrl,data).success(function(data){self.deferredHandler(data,deferred)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_modifying"))})["finally"](function(){self.inprocess=!1}),deferred.promise},Item.prototype.changePermissions=function(){var self=this,deferred=$q.defer(),data={params:{mode:"changepermissions",path:self.tempModel.fullPath(),perms:self.tempModel.perms.toOctal(),permsCode:self.tempModel.perms.toCode(),recursive:self.tempModel.recursive}};return self.inprocess=!0,self.error="",$http.post(fileManagerConfig.permissionsUrl,data).success(function(data){self.deferredHandler(data,deferred)}).error(function(data){self.deferredHandler(data,deferred,$translate.instant("error_changing_perms"))})["finally"](function(){self.inprocess=!1}),deferred.promise},Item.prototype.isFolder=function(){return"dir"===this.model.type},Item.prototype.isEditable=function(){return!this.isFolder()&&fileManagerConfig.isEditableFilePattern.test(this.model.name)},Item.prototype.isImage=function(){return fileManagerConfig.isImageFilePattern.test(this.model.name)},Item.prototype.isCompressible=function(){return this.isFolder()},Item.prototype.isExtractable=function(){return!this.isFolder()&&fileManagerConfig.isExtractableFilePattern.test(this.model.name)},Item}])}(window,angular,jQuery),function(angular){"use strict";var app=angular.module("FileManagerApp");app.filter("strLimit",["$filter",function($filter){return function(input,limit){return input.length<=limit?input:$filter("limitTo")(input,limit)+"..."}}]),app.filter("formatDate",["$filter",function($filter){return function(input,limit){return input instanceof Date?input.toISOString().substring(0,19).replace("T"," "):(input.toLocaleString||input.toString).apply(input)}}]),app.filter("fileIcon",["$filter",function($filter){return function(fname){var extensionIcons={parentdir:"fa-level-up fa-flip-horizontal",xls:"fa-file-excel-o",xlsx:"fa-file-excel-o",doc:"fa-file-word-o",docx:"fa-file-word-o",ppt:"fa-file-powerpoint-o",pptx:"fa-file-powerpoint-o",pdf:"fa-file-pdf-o",mpg4:" ",hqx:"fa-file-archive-o",cpt:"fa-file-archive-o",csv:"fa-file-code-o",bin:"fa-file-exe-o",dms:"",lha:"",lzh:"",exe:"fa-file-exe-o","class":"fa-file-code-o",psd:"",so:"",sea:"",dll:"fa-file-exe-o",oda:"",ai:"",eps:"",ps:"",smi:"",smil:"",mif:"fa-file-code-o",wbxml:"fa-file-code-o",wmlc:"fa-file-code-o",dcr:"fa-file-movie-o",dir:"fa-file-movie-o",dxr:"fa-file-movie-o",dvi:"fa-file-movie-o",gtar:"fa-file-archive-o",gz:"fa-file-archive-o",php:"fa-file-code-o",php4:"fa-file-code-o",php3:"fa-file-code-o",phtml:"fa-file-code-o",phps:"fa-file-code-o",js:"fa-file-code-o",swf:"fa-file-code-o",sit:"fa-file-archive-o",tar:"fa-file-archive-o",tgz:"fa-file-archive-o",xhtml:"fa-file-code-o",xht:"fa-file-code-o",zip:"fa-file-zip-o",mid:"fa-file-audio-o",midi:"fa-file-audio-o",mpga:"fa-file-audio-o",mp2:"fa-file-audio-o",mp3:"fa-file-audio-o",aif:"fa-file-audio-o",aiff:"fa-file-audio-o",aifc:"fa-file-audio-o",ram:"fa-file-audio-o",rm:"fa-file-audio-o",rpm:"fa-file-audio-o",ra:"fa-file-audio-o",rv:"fa-file-movie-o",wav:"fa-file-audio-o",bmp:"fa-file-image-o",gif:"fa-file-image-o",jpeg:"fa-file-image-o",jpg:"fa-file-image-o",jpe:"fa-file-image-o",png:"fa-file-image-o",tiff:"fa-file-image-o",tif:"fa-file-image-o",css:"fa-file-code-o",html:"fa-file-code-o",htm:"fa-file-code-o",shtml:"fa-file-code-o",txt:"fa-file-text-o",text:"fa-file-text-o",log:"fa-file-text-o",rtx:"fa-file-text-o",rtf:"fa-file-text-o",xml:"fa-file-code-o",xsl:"fa-file-code-o",mpeg:"fa-file-movie-o",mpg:"fa-file-movie-o",mpe:"fa-file-movie-o",qt:"fa-file-movie-o",mov:"fa-file-movie-o",avi:"fa-file-movie-o",movie:"fa-file-movie-o",eml:"",json:"fa-file-code-o"},extension=fname.substr((~-fname.lastIndexOf(".")>>>0)+2);if(extension){var iconClass=extensionIcons[extension.toLowerCase()];return iconClass?iconClass:"fa-file-o"}return"fa-file-o"}}]),app.filter("codeMirrorEditorMode",["$filter",function($filter){return function(fname){var editorModeMap={groovy:"groovy",ini:"properties",properties:"properties",css:"css",scss:"css",html:"htmlmixed",htm:"htmlmixed",shtm:"htmlmixed",shtml:"htmlmixed",xhtml:"htmlmixed",cfm:"htmlmixed",cfml:"htmlmixed",cfc:"htmlmixed",dhtml:"htmlmixed",xht:"htmlmixed",tpl:"htmlmixed",twig:"htmlmixed",hbs:"htmlmixed",handlebars:"htmlmixed",kit:"htmlmixed",jsp:"htmlmixed",aspx:"htmlmixed",ascx:"htmlmixed",asp:"htmlmixed",master:"htmlmixed",cshtml:"htmlmixed",vbhtml:"htmlmixed",ejs:"htmlembedded",dust:"htmlembedded",erb:"htmlembedded",jade:"jade",js:"javascript",jsx:"javascript",jsm:"javascript",_js:"javascript",vbs:"vbscript",vb:"vb",json:"javascript",xml:"xml",svg:"xml",wxs:"xml",wxl:"xml",wsdl:"xml",rss:"xml",atom:"xml",rdf:"xml",xslt:"xml",xsl:"xml",xul:"xml",xbl:"xml",mathml:"xml",config:"xml",plist:"xml",xaml:"xml",php:"php",php3:"php",php4:"php",php5:"php",phtm:"php",phtml:"php",ctp:"php",c:"clike",h:"clike",i:"clike",cc:"clike",cp:"clike",cpp:"clike","c++":"clike",cxx:"clike",hh:"clike",hpp:"clike",hxx:"clike","h++":"clike",ii:"clike",ino:"clike",cs:"clike",asax:"clike",ashx:"clike",java:"clike",scala:"clike",sbt:"clike",coffee:"coffeescript",cf:"coffeescript",cson:"coffeescript",_coffee:"coffeescript",clj:"clojure",cljs:"clojure",cljx:"clojure",pl:"perl",pm:"perl",rb:"ruby",ru:"ruby",gemspec:"ruby",rake:"ruby",py:"python",pyw:"python",wsgi:"python",sass:"sass",lua:"lua",sql:"sql",diff:"diff",patch:"diff",md:"markdown",markdown:"markdown",mdown:"markdown",mkdn:"markdown",yaml:"yaml",yml:"yaml",hx:"haxe",sh:"shell",command:"shell",bash:"shell"},extension=fname.substr((~-fname.lastIndexOf(".")>>>0)+2);if(extension){var editorMode=editorModeMap[extension.toLowerCase()];return editorMode?editorMode:""}return""}}]),app.filter("humanReadableFileSize",["$filter","fileManagerConfig",function($filter,fileManagerConfig){var decimalByteUnits=[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"],binaryByteUnits=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];return function(input){var i=-1,fileSizeInBytes=input;do fileSizeInBytes/=1024,i++;while(fileSizeInBytes>1024);var result=fileManagerConfig.useBinarySizePrefixes?binaryByteUnits[i]:decimalByteUnits[i];return Math.max(fileSizeInBytes,.1).toFixed(1)+" "+result}}]).filter("humanSize",function(){return function(size,precision,plainText){if(0!==precision&&null!==precision||(precision=1),0===size||null===size)return"0B";if(isNaN(size))return"";var sizes=["B","KB","MB","GB","TB"],posttxt=0;if(size<1024)return plainText?Number(size)+sizes[posttxt]:Number(size)+'<font class="units">'+sizes[posttxt]+"</font>";for(;size>=1024;)posttxt++,size/=1024;var power=Math.pow(10,precision),poweredVal=Math.ceil(size*power);return size=poweredVal/power,plainText?size+sizes[posttxt]:size+'<font class="units">'+sizes[posttxt]+"</font>"}}),app.filter("humanReadableFileSize",["$filter","fileManagerConfig",function($filter,fileManagerConfig){var decimalByteUnits=[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"],binaryByteUnits=["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];return function(input){var i=-1,fileSizeInBytes=input;do fileSizeInBytes/=1024,i++;while(fileSizeInBytes>1024);var result=fileManagerConfig.useBinarySizePrefixes?binaryByteUnits[i]:decimalByteUnits[i];return Math.max(fileSizeInBytes,.1).toFixed(1)+" "+result}}]).filter("hasDirectories",function($filter){return function(fileList){var hasDirectories=!1;return angular.forEach(fileList,function(fileItem,iter){if(fileItem.path)return hasDirectories=!0,!1}),hasDirectories}}).filter("deepPropertyFilter",function($log){function getPath(obj,ks){if("string"==typeof ks&&(ks=ks.split(".")),void 0!==obj){if(0===ks.length)return obj;if(null!==obj)return getPath(obj[_.first(ks)],_.rest(ks))}}return function(items,props){var out=[];if(angular.isArray(items)){var strippedProps={},propKeys=Object.keys(props);return propKeys.forEach(function(propKey){var propVal=props[propKey]||"";strippedProps[propKey]=propVal.toString().toLowerCase().replace(/ /g,"")}),_.filter(items,function(item){return _.some(strippedProps,function(propVal,propKey){var itemVal=getPath(item,propKey)||"";if(itemVal=itemVal.toString().toLowerCase().replace(/ /g,""),itemVal.indexOf(propVal)!==-1)return!0})})}return out=items}}).filter("propertyFilter",function($log,$filter){return function(items,props){var out=[];return angular.isArray(items)?items.forEach(function(item){for(var itemMatches=!1,keys=Object.keys(props),optionValue="",i=0;i<keys.length;i++)optionValue=item[keys[i]]?optionValue+item[keys[i]].toString().toLowerCase().replace(/ /g,""):"";for(var j=0;j<keys.length;j++){var text=props[keys[j]].toLowerCase().replace(/ /g,"");if(optionValue.indexOf(text)!==-1){itemMatches=!0;break}}itemMatches&&out.push(item)}):out=items,out}})}(angular),function(angular){"use strict";angular.module("FileManagerApp").provider("fileManagerConfig",function(){var values={appName:"AgaveTo Data Explorer",defaultLang:"en",listUrl:"",uploadUrl:"",renameUrl:"",copyUrl:"",removeUrl:"",editUrl:"",getContentUrl:"",createFolderUrl:"",downloadFileUrl:"",compressUrl:"",extractUrl:"",permissionsUrl:"",layout:"boxed",sidebar:!0,breadcrumb:!0,allowedActions:{rename:!0,copy:!0,edit:!0,changePermissions:!0,compress:!0,compressChooseName:!0,extract:!1,download:!0,preview:!0,remove:!0,postits:!0,publish:!1,notifications:!0},enablePermissionsRecursive:!0,compressAsync:!0,extractAsync:!0,isEditableFilePattern:/\.(txt|html?|aspx?|ini|pl|py|md|css|js|log|htaccess|htpasswd|json|sql|xml|xslt?|sh|rb|as|bat|cmd|coffee|php[3-6]?|java|c|cbl|go|h|scala|vb|md|err|out|scala|groovy|zsh|csh|pub|agave|csv|dat|fasta|pdb|properties|tsv|submit|batch|config|cfg|conf|ya?ml|htaccess|swagger|toml|git(.*)|docker(.*)|bash(.*)|agave(.*)|profile)$/i,isPreviewableFilePattern:/\.(txt|html?|aspx?|ini|pl|py|md|css|js|log|htaccess|htpasswd|json|sql|xml|xslt?|sh|rb|as|bat|cmd|coffee|php[3-6]?|java|c|cbl|go|h|scala|vb|md|err|out|scala|groovy|zsh|csh|jpe?g|gif|bmp|png|pdf|svg||agave|csv|dat|fasta|pdb|properties|submit|batch|tsv|ya?ml|config|cfg|conf|swagger|toml|git(.*)|docker(.*)|bash(.*)|agave(.*)|profile|^([^.]+)|tiff?)$/i,isTextFilePattern:/\.(json|err|out|m|tex|sh|log|txt|tcl|config|cfg|conf|^git|^docker)$/i,isImageFilePattern:/\.(jpe?g|gif|bmp|png|svg|tiff?)$/i,isExtractableFilePattern:/\.(gz|tar|rar|bz2?|g?zip)$/i,isPdfFilePattern:/\.pdf$/i,maxPreviewSize:1048576,maxEditSize:3145728,tplPath:"src/templates"};return{$get:function(){return values},set:function(constants){angular.extend(values,constants)}}})}(angular),function(angular){"use strict";angular.module("FileManagerApp").config(["$translateProvider",function($translateProvider){$translateProvider.translations("en",{filemanager:"File Manager",language:"Language",english:"English",spanish:"Spanish",portuguese:"Portuguese",french:"French",confirm:"Confirm",cancel:"Cancel",close:"Close",upload_files:"Upload files",upload_file:"Upload file",files_will_uploaded_to:"Files will be uploaded to",select_files:"Select files",uploading:"Uploading",permissions:"Permissions",select_destination_folder:"Select the destination folder",source:"Source",destination:"Destination",copy_file:"Copy file",sure_to_delete:"Are you sure to delete",change_name_move:"Change name / move",enter_new_name_for:"Enter new name for",extract_item:"Extract item",extraction_started:"Extraction started in a background process",compression_started:"Compression started in a background process",enter_folder_name_for_extraction:"Enter the folder name for the extraction of",enter_folder_name_for_compression:"Enter the folder name for the compression of",toggle_fullscreen:"Toggle fullscreen",edit_file:"Edit file",file_content:"File content",loading:"Loading",search:"Search",create_folder:"Create folder",create:"Create",folder_name:"Folder name",upload:"Upload",change_permissions:"Change permissions",change:"Change",details:"Details",icons:"Icons",list:"List",name:"Name",size:"Size",actions:"Actions",date:"Date",no_files_in_folder:"No files in this folder",no_folders_in_folder:"This folder not contains children folders",select_this:"Select this",select_new_destination:"Select destination",go_back:"Go back",wait:"Wait",move:"Move",download:"Download",view_item:"View item",remove:"Delete",edit:"Edit",copy:"Copy",rename:"Rename",extract:"Extract",compress:"Compress",error_invalid_filename:"Invalid filename or already exists, specify another name",error_modifying:"An error occurred modifying the file",error_deleting:"An error occurred deleting the file or folder",error_displaying:"An error occurred displaying the file",error_renaming:"An error occurred renaming the file",error_copying:"An error occurred copying the file",error_compressing:"An error occurred compressing the file or folder",error_extracting:"An error occurred extracting the file",error_saving:"An error ocurred saving the file",error_creating_folder:"An error occurred creating the folder",error_getting_content:"An error occurred getting the content of the file",error_changing_perms:"An error occurred changing the permissions of the file",error_uploading_files:"An error occurred uploading files",error_downloading_files:"An error occurred downloading files",error_deleting_files:"An error occurred deleting files",error_notifications_files:"An error ocurred trying to get file notifications",sure_to_start_compression_with:"Are you sure to compress",owner:"Owner",group:"Group",others:"Others",read:"Read",write:"Write",exec:"Exec",execute:"Execute",original:"Original",changes:"Changes",recursive:"Recursive",user:"User",preview:"Preview",previewing:"Previewing",editing:"Editing",save:"Save",postit:"Postit",notifications:"Notifications"}),$translateProvider.translations("pt",{filemanager:"Gerenciador de arquivos",language:"Lngua",english:"Ingls",spanish:"Espanhol",portuguese:"Portugues",french:"Francs",confirm:"Confirmar",cancel:"Cancelar",close:"Fechar",upload_file:"Carregar arquivo",files_will_uploaded_to:"Os arquivos sero enviados para",uploading:"Carregar",permissions:"Autorizaes",select_destination_folder:"Selecione a pasta de destino",source:"Origem",destination:"Destino",copy_file:"Copiar arquivo",sure_to_delete:"Tem certeza de que deseja apagar",change_name_move:"Renomear / mudana",enter_new_name_for:"Digite o novo nome para",extract_item:"Extrair arquivo",extraction_started:"A extrao comeou em um processo em segundo plano",compression_started:"A compresso comeou em um processo em segundo plano",enter_folder_name_for_extraction:"Digite o nome da pasta para a extrao de",enter_folder_name_for_compression:"Digite o nome da pasta para Compresso",toggle_fullscreen:"Ativar/desativar tela cheia",edit_file:"Editar arquivo",file_content:"Contedo do arquivo",loading:"Carregando",search:"Localizar",create_folder:"Criar Pasta",create:"Criar",folder_name:"Nome da pasta",upload:"Fazer",change_permissions:"Alterar permisses",change:"Alterar",details:"Detalhes",icons:"Icones",list:"Lista",name:"Nome",size:"Tamanho",actions:"Aes",date:"Data",no_files_in_folder:"No h arquivos nesta pasta",no_folders_in_folder:"Esta pasta no contm subpastas",select_this:"Selecione esta",go_back:"Voltar",wait:"Espere",move:"Mover",download:"Baixar",view_item:"Veja o arquivo",remove:"Excluir",edit:"Editar",copy:"Copiar",rename:"Renomear",extract:"Extrair",compress:"Comprimir",error_invalid_filename:"Nome do arquivo invlido ou nome de arquivo j existe, especifique outro nome",error_modifying:"Ocorreu um erro ao modificar o arquivo",error_deleting:"Ocorreu um erro ao excluir o arquivo ou pasta",error_renaming:"Ocorreu um erro ao mudar o nome do arquivo",error_copying:"Ocorreu um erro ao copiar o arquivo",error_compressing:"Ocorreu um erro ao comprimir o arquivo ou pasta",error_extracting:"Ocorreu um erro ao extrair o arquivo",error_creating_folder:"Ocorreu um erro ao criar a pasta",error_getting_content:"Ocorreu um erro ao obter o contedo do arquivo",error_changing_perms:"Ocorreu um erro ao alterar as permisses do arquivo",error_uploading_files:"Ocorreu um erro upload de arquivos",sure_to_start_compression_with:"Tem certeza que deseja comprimir",owner:"Proprietrio",group:"Grupo",others:"Outros",read:"Leitura",write:"Escrita ",exec:"Execuo",original:"Original",changes:"Mudanas",recursive:"Recursiva"}),$translateProvider.translations("es",{filemanager:"Administrador de archivos",language:"Idioma",english:"Ingles",spanish:"Espaol",portuguese:"Portugues",french:"Francs",confirm:"Confirmar",cancel:"Cancelar",close:"Cerrar",upload_file:"Subir archivo",files_will_uploaded_to:"Los archivos seran subidos a",uploading:"Subiendo",permissions:"Permisos",select_destination_folder:"Seleccione la carpeta de destino",source:"Origen",destination:"Destino",copy_file:"Copiar archivo",sure_to_delete:"Esta seguro que desea eliminar",change_name_move:"Renombrar / mover",enter_new_name_for:"Ingrese el nuevo nombre para",extract_item:"Extraer archivo",extraction_started:"La extraccion ha comenzado en un proceso de segundo plano",compression_started:"La compresion ha comenzado en un proceso de segundo plano",enter_folder_name_for_extraction:"Ingrese el nombre de la carpeta para la extraccion de",enter_folder_name_for_compression:"Ingrese el nombre de la carpeta para la compresion de",toggle_fullscreen:"Activar/Desactivar pantalla completa",edit_file:"Editar archivo",file_content:"Contenido del archivo",loading:"Cargando",search:"Buscar",create_folder:"Crear carpeta",create:"Crear",folder_name:"Nombre de la carpeta",upload:"Subir",change_permissions:"Cambiar permisos",change:"Cambiar",details:"Detalles",icons:"Iconos",list:"Lista",name:"Nombre",size:"Tamao",actions:"Acciones",date:"Fecha",no_files_in_folder:"No hay archivos en esta carpeta",no_folders_in_folder:"Esta carpeta no contiene sub-carpetas",select_this:"Seleccionar esta",go_back:"Volver",wait:"Espere",move:"Mover",download:"Descargar",view_item:"Ver archivo",remove:"Eliminar",edit:"Editar",copy:"Copiar",rename:"Renombrar",extract:"Extraer",compress:"Comprimir",error_invalid_filename:"El nombre del archivo es invalido o ya existe",error_modifying:"Ocurrio un error al intentar modificar el archivo",error_deleting:"Ocurrio un error al intentar eliminar el archivo",error_renaming:"Ocurrio un error al intentar renombrar el archivo",error_copying:"Ocurrio un error al intentar copiar el archivo",error_compressing:"Ocurrio un error al intentar comprimir el archivo",error_extracting:"Ocurrio un error al intentar extraer el archivo",error_creating_folder:"Ocurrio un error al intentar crear la carpeta",error_getting_content:"Ocurrio un error al obtener el contenido del archivo",error_changing_perms:"Ocurrio un error al cambiar los permisos del archivo",error_uploading_files:"Ocurrio un error al subir archivos",sure_to_start_compression_with:"Esta seguro que desea comprimir",owner:"Propietario",group:"Grupo",others:"Otros",read:"Lectura",write:"Escritura",exec:"Ejecucion",original:"Original",changes:"Cambios",recursive:"Recursivo"}),$translateProvider.translations("fr",{filemanager:"Gestionnaire de fichier",language:"Langue",english:"Anglais",spanish:"Espagnol",portuguese:"Portugais",french:"Franais",confirm:"Confirmer",cancel:"Annuler",close:"Fermer",upload_file:"Uploader un fichier",files_will_uploaded_to:"Les fichiers seront upload dans",uploading:"Upload en cours",permissions:"Permissions",select_destination_folder:"Slectionn le dossier de destination",source:"Source",destination:"Destination",copy_file:"Copier le fichier",sure_to_delete:"tes-vous sr de vouloir supprimer",change_name_move:"Renommer / Dplacer",enter_new_name_for:"Entrer le nouveau nom pour",
extract_item:"Extraires les lments",extraction_started:"L'extraction a dmarr en tche de fond",compression_started:"La compression a dmarr en tche de fond",enter_folder_name_for_extraction:"Entrer le nom du dossier pour l'extraction de",enter_folder_name_for_compression:"Entrer le nom du dossier pour la compression de",toggle_fullscreen:"Basculer en plein cran",edit_file:"diter le fichier",file_content:"Contenu du fichier",loading:"Chargement en cours",search:"Recherche",create_folder:"Crer un dossier",create:"Crer",folder_name:"Nom du dossier",upload:"Upload",change_permissions:"Changer les permissions",change:"Changer",details:"Details",icons:"Icons",list:"Liste",name:"Nom",size:"Taille",actions:"Actions",date:"Date",no_files_in_folder:"Aucun fichier dans ce dossier",no_folders_in_folder:"Ce dossier ne contiens pas de dossier",select_this:"Slectionner",go_back:"Retour",wait:"Patienter",move:"Dplacer",download:"Tlcharger",view_item:"Voir l'lment",remove:"Supprimer",edit:"diter",copy:"Copier",rename:"Renommer",extract:"Extraire",compress:"Compresser",error_invalid_filename:"Nom de fichier invalide ou dj existant, merci de spcifier un autre nom",error_modifying:"Une erreur est survenue pendant la modification du fichier",error_deleting:"Une erreur est survenue pendant la suppression du fichier ou du dossier",error_renaming:"Une erreur est survenue pendant le renommage du fichier",error_copying:"Une erreur est survenue pendant la copie du fichier",error_compressing:"Une erreur est survenue pendant la compression du fichier ou du dossier",error_extracting:"Une erreur est survenue pendant l'extraction du fichier",error_creating_folder:"Une erreur est survenue pendant la cration du dossier",error_getting_content:"Une erreur est survenue pendant la rcupration du contenu du fichier",error_changing_perms:"Une erreur est survenue pendant le changement des permissions du fichier",error_uploading_files:"Une erreur est survenue pendant l'upload des fichiers",sure_to_start_compression_with:"tes-vous sre de vouloir compresser",owner:"Propritaire",group:"Groupe",others:"Autres",read:"Lecture",write:"criture",exec:"xcution",original:"Original",changes:"Modifications",recursive:"Rcursif"})}])}(angular),function(angular){"use strict";angular.module("FileManagerApp").service("fileNavigator",["$http","$q","$rootScope","fileManagerConfig","FilesController","fileItem","$localStorage",function($http,$q,$rootScope,fileManagerConfig,FilesController,fileItem,$localStorage){var FileNavigator=function(system,path){this.requesting=!1,this.fileList=[],this.fileListSelected=[],this.system=system,this.crumbsPath="",this.isAbsolutePath=path&&"/"==path[0],system?path?"/"===path[0]?this.currentPath=path.split("/"):this.currentPath=path.split("/"):"/"===system.storage.homeDir[0]?this.currentPath=system.storage.homeDir.split("/"):this.currentPath=system.storage.homeDir.split("/"):path?this.currentPath=path.split("/"):this.currentPath=[],this.history=[],this.error=""};return FileNavigator.prototype.deferredHandler=function(data,deferred,defaultMsg){return data&&"object"==typeof data||(this.error=data),this.error?deferred.reject(data):deferred.resolve(data)},FileNavigator.prototype.list=function(){var self=this,deferred=$q.defer(),path="";return self.requesting=!0,self.fileList=[],self.error="",self.system?(path=self.currentPath.join("/"),FilesController.listFileItems(self.system.id,path,999999,0).then(function(data){self.deferredHandler(data,deferred)},function(data){self.error="Could not list files for this path",self.deferredHandler(data,deferred,"Unknown error listing, check the response")})["finally"](function(data){self.requesting=!1}),deferred.promise):$q(function(resolve,reject){setTimeout(function(){reject("No system selected. Please select a valid system to browse.")},50)})},FileNavigator.prototype.refresh=function(){var self=this,path=self.currentPath.join("/");return self.list().then(function(data){angular.forEach(data||[],function(file,key){"."!==file.name&&".."!==file.name&&self.fileList.push(new fileItem(file,self.currentPath,self.system))}),self.crumbsPath||(self.fileList.length>0?self.crumbsPath=self.fileList[0].model.crumbsPath().slice(0,-1).splice(1):self.crumbsPath=self.currentPath);var rootItem=new fileItem;"undefined"!=typeof self.fileList[0]?angular.copy(self.fileList[0],rootItem):rootItem.model.path=self.currentPath,rootItem.model.name=0===self.currentPath.length?"":self.currentPath[self.currentPath.length-1],rootItem.model.fileType="folder",rootItem.model.type="dir",rootItem.model.root=!0,rootItem.tempModel=rootItem.model,self.fileList.unshift(rootItem),self.buildTree(path)})},FileNavigator.prototype.buildTree=function(path){function recursive(parent,item,path){var absName=path?path+"/"+item.model.name:item.model.name;if(parent.name.trim()&&0!==path.trim().indexOf(parent.name)&&(parent.nodes=[]),parent.name!==path)for(var i in parent.nodes)recursive(parent.nodes[i],item,path);else{for(var e in parent.nodes)if(parent.nodes[e].name===absName)return;parent.nodes.push({item:item,name:absName,nodes:[]})}parent.nodes=parent.nodes.sort(function(a,b){return a.name<b.name?-1:a.name===b.name?0:1})}var self=this;self.history.length?""!==self.history[0].name&&(self.history=[],self.history.push({name:path,nodes:[]})):self.history.push({name:path,nodes:[]});for(var o in self.fileList){var item=self.fileList[o];item.isFolder()&&recursive(self.history[0],item,path)}},FileNavigator.prototype.folderClick=function(item){var self=this;item&&item.isFolder()&&"undefined"==typeof item.model.root&&(self.currentPath=[],self.currentPath=item.model.fullPath().split("/"),self.crumbsPath=item.model.crumbsPath()),self.refresh()},FileNavigator.prototype.upDir=function(){var self=this;angular.isUndefined(self.currentPath[0])||(self.currentPath.length<=2&&""==self.currentPath[0]?(self.currentPath="/".split("/"),self.crumbsPath=[""]):(self.currentPath=self.currentPath.slice(0,-1),self.crumbsPath=self.crumbsPath.slice(0,-1)),self.refresh())},FileNavigator.prototype.goHome=function(){var self=this;self.currentPath=self.system.storage.homeDir.split("/"),self.system["public"]&&(self.currentPath.length?self.currentPath.push($localStorage.activeProfile.username):self.currentPath=[$localStorage.activeProfile.username]),self.refresh()},FileNavigator.prototype.goTo=function(index){var self=this;self.currentPath=self.currentPath.slice(0,index+1),self.crumbsPath=self.crumbsPath.slice(0,index+1),1==self.currentPath.length&&""==self.currentPath[0]&&(self.currentPath="/".split("/"),self.crumbsPath=[""]),self.refresh()},FileNavigator.prototype.fileNameExists=function(fileName){var self=this;for(var item in self.fileList)if(item=self.fileList[item],fileName.trim&&item.model.name.trim()===fileName.trim())return!0},FileNavigator.prototype.listHasFolders=function(){var self=this;for(var item in self.fileList)if("dir"===self.fileList[item].model.type)return!0},FileNavigator}])}(angular),function(window,angular){"use strict";angular.module("FileManagerApp").service("fileUploader",["$http","$q","fileManagerConfig","Configuration","Upload","PostitsController","FilesController",function($http,$q,fileManagerConfig,Configuration,Upload,PostitsController,FilesController){function deferredHandler(data,deferred,errorMessage){return data&&"object"==typeof data?data.result&&data.result.error?deferred.reject(data):data.error?deferred.reject(data):errorMessage?deferred.reject(errorMessage):void deferred.resolve(data):deferred.reject("Bridge response error, please check the docs")}this.files=[],this.uploadFile=function(file,form,filesUri,callback){var filepath=(file.path||file.webkitRelativePath).split("/");return filepath.length&&0==filepath[0].length&&filepath.pop(),Upload.upload({url:filesUri+"/"+filepath.join("/")+"?naked=true",data:{file:file,fileToUpload:file,append:!1,fileType:"raw"},method:"POST",headers:{"Content-Type":void 0,Authorization:"Bearer "+Configuration.oAuthAccessToken}}).then(function(resp){return callback(resp.data)},function(resp){},function(evt){file.progress=Math.min(100,parseInt(100*evt.loaded/evt.total))})},this.makeFolders=function(fileList,system,path){var promises=[],self=this;Configuration.BASEURI+"files/v2/media/system/"+system.id+"//?naked=true&action=mkdir";angular.forEach(fileList,function(fileObj,key){if(self.requesting=!0,"directory"==fileObj.type){var body={};body.action="mkdir",body.path=fileObj.path,promises.push(FilesController.updateInvokeFileItemAction(body,system.id,path.join("/")).then(function(data){},function(data){}))}});var deferred=$q.defer();return $q.all(promises).then(function(data){return deferredHandler(data,deferred),!0},function(data){return deferredHandler(data,deferred,$translate.instant("error_uploading_directory")),!1})},this.requesting=!1,this.upload=function(fileList,system,path){if(!window.FormData)throw new Error("Unsupported browser version");var self=this,promises=[];return self.makeFolders(fileList,system,path).then(function(response){angular.forEach(fileList,function(fileObj,key){if("directory"!=fileObj.type){var form=new window.FormData;fileObj instanceof window.File&&(form.append("fileToUpload",fileObj),form.append("append",!1),form.append("fileType","raw")),self.requesting=!0;var filesUri=Configuration.BASEURI+"files/v2/media/system/"+system.id+"/"+path.join("/");promises.push(self.uploadFile(fileObj,form,filesUri,function(value){self.files.push(value)}))}});var deferred=$q.defer();return $q.all(promises).then(function(data){deferredHandler(data,deferred)},function(data){deferredHandler(data,deferred,$translate.instant("error_uploading_files"))})["finally"](function(data){self.requesting=!1})})},this.download=function(file,callback){var data={force:"true"},postitIt=new PostItRequest;return postitIt.setMaxUses(2),postitIt.setMethod("GET"),postitIt.setUrl([decodeURIComponent(file.model._links.self.href),$.param(data)].join("?")),PostitsController.addPostit(postitIt).then(function(resp){if("dir"!==file.model.type){var link=document.createElement("a");link.setAttribute("download",null),link.setAttribute("href",resp._links.self.href),link.style.display="none",document.body.appendChild(link),link.click(),document.body.removeChild(link)}return callback(resp.data)})},this.downloadSelected=function(fileListSelected){var self=this,promises=[];angular.forEach(fileListSelected,function(file){promises.push(self.download(file,function(value){self.files.push(value)}))});var deferred=$q.defer();return $q.all(promises).then(function(data){deferredHandler(data,deferred)},function(data){deferredHandler(data,deferred,$translate.instant("error_dowwnloading_files"))})},this["delete"]=function(file,callback){if(file.model.path&&file.model.name){var path=file.model.path.join("/")+"/"+file.model.name,systemId=file.model.system.id;return FilesController.deleteFileItem(path,systemId).then(function(resp){return callback(resp.data)})}},this.deleteSelected=function(fileListSelected){var self=this,promises=[];angular.forEach(fileListSelected,function(file){promises.push(self["delete"](file,function(value){self.files.push(value)}))});var deferred=$q.defer();return $q.all(promises).then(function(data){deferredHandler(data,deferred)},function(data){deferredHandler(data,deferred,"Error deleting files")})}}])}(window,angular),angular.module("FileManagerApp").run(["$templateCache",function($templateCache){$templateCache.put("src/templates/current-folder-breadcrumb.html",'<ol class="breadcrumb mb0" ng-show="fileNavigator.crumbsPath.length > 0">\r    <li ng-repeat="(key, dir) in fileNavigator.crumbsPath track by key" ng-class="{\'active\':$last}" class="animated fast fadeIn">\r        <a href="" ng-show="!$last" ng-click="fileNavigator.goTo(key)">\r         <span class="path-wrap"><i class="glyphicon glyphicon-folder-open mr2"></i> {{dir || \'/\' }}</span>\r        </a>\r        <span ng-show="$last" class="path-wrap"><i class="glyphicon glyphicon-folder-open mr2"></i>  {{dir || \'/\' }}</span>\r    </li>\r    <li ng-show="fileNavigator.crumbsPath.length > 0"><button class="btn btn-primary btn-xs" ng-click="fileNavigator.upDir()">&crarr;</button></li>\r</ol>\r'),$templateCache.put("src/templates/item-context-menu.html",'<div id="context-menu" class="dropdown clearfix animated fast fadeIn">\r    <ul class="dropdown-menu dropdown-right-click" role="menu" aria-labelledby="dropdownMenu" style="">\r        <li ng-if="config.allowedActions.rename"><a href="" tabindex="-1" data-toggle="modal" data-target="#rename"><i class="fa fa-edit"></i> {{\'rename\' | translate}}</a></li>\r        <li ng-if="config.allowedActions.copy"><a href="" tabindex="-1" data-toggle="modal" data-target="#copy" ng-click="initCopySystem(temp.model.system)"><i class="fa fa-copy"></i> {{\'copy\' | translate}}</a></li>\r        <!-- <li ng-if="config.allowedActions.edit && temp.isEditable()"><a href="" tabindex="-1" ng-click="edit(temp)"><i class="fa fa-pencil"></i> {{\'edit\' | translate}}</a></li> -->\r        <li ng-if="config.allowedActions.compress && temp.isCompressible()"><a href="" tabindex="-1" data-toggle="modal" data-target="#compress"><i class="glyphicon glyphicon-compressed"></i> {{\'compress\' | translate}}</a></li>\r        <li ng-if="config.allowedActions.extract && temp.isExtractable()"><a href="" tabindex="-1" data-toggle="modal" data-target="#extract" ng-click="temp.tempModel.name=\'\'"><i class="glyphicon glyphicon-export"></i> {{\'extract\' | translate}}</a></li>\r        <li ng-if="config.allowedActions.download && !temp.isFolder()"><a href="" tabindex="-1" ng-click="temp.download()"><i class="fa fa-download"></i> {{\'download\' | translate}}</a></li>\r        <li ng-if="config.allowedActions.preview && temp.isPreviewable()"><a href="" tabindex="-1" data-toggle="modal" data-target="#preview" ng-click="temp.download(true)"><i class="fa fa-eye"></i> {{\'preview\' | translate}}</a></li>\r        <li class="divider"></li>\r        <li ng-if="config.allowedActions.publish"><a href="" tabindex="-1" data-toggle="modal" data-target="#publish"><i class="fa fa-globe"></i> Publish </a></li>\r        <li ng-if="config.allowedActions.postits && !temp.isFolder()"><a href="" tabindex="-1" data-toggle="modal" data-target="#postit"><i class="fa fa-link"></i> get link</a></li>\r        <li ng-if="config.allowedActions.changePermissions"><a href="" tabindex="-1" ng-click="editPermissions(temp)"><i class="fa fa-lock"></i> {{\'permissions\' | translate}}</a></li>\r        <li ng-if="config.allowedActions.notifications"><a href="" ng-click="temp.notifications()" ><i class="fa fa-bell"></i> {{\'notifications\' | translate}}</a></li>\r        <li class="divider"></li>\r        <li ng-if="config.allowedActions.remove"><a href="" tabindex="-1" data-toggle="modal" data-target="#delete"><i class="fa fa-trash"></i> {{\'remove\' | translate}}</a></li>\r    </ul>\r</div>\r'),$templateCache.put("src/templates/item-toolbar.html",'<div ng-show="!item.inprocess">\n    <button class="btn btn-sm btn-outline btn-icon-only dark" data-toggle="modal" data-target="#rename" ng-show="config.allowedActions.rename" ng-click="touch(item)" title="{{\'rename\' | translate}}">\n        <i class="fa fa-lg fa-edit"></i>\n    </button>\n    <button class="btn btn-sm btn-outline btn-icon-only dark" data-toggle="modal" data-target="#copy" ng-show="config.allowedActions.copy && !item.isFolder()" ng-click="touch(item)" title="{{\'copy\' | translate}}">\n        <i class="fa fa-lg fa-copy"></i>\n    </button>\n    <button class="btn btn-sm btn-outline btn-icon-only dark" data-toggle="modal" data-target="#edit" ng-show="config.allowedActions.edit && item.isEditable()" ng-click="item.getContent(); touch(item)" title="{{\'edit\' | translate}}">\n        <i class="fa fa-lg fa-pencil"></i>\n    </button>\n    <button class="btn btn-sm btn-outline btn-icon-only dark" data-toggle="modal" data-target="#changepermissions" ng-show="config.allowedActions.changePermissions" ng-click="touch(item)" title="{{\'permissions\' | translate}}">\n        <i class="fa fa-lg fa-lock"></i>\n    </button>\n    <button class="btn btn-sm btn-outline btn-icon-only dark" data-toggle="modal" data-target="#compress" ng-show="config.allowedActions.compress && item.isCompressible()" ng-click="touch(item)" title="{{\'compress\' | translate}}">\n        <i class="glyphicon fa-lg glyphicon-compressed"></i>\n    </button>\n    <button class="btn btn-sm btn-outline btn-icon-only dark" data-toggle="modal" data-target="#extract" ng-show="config.allowedActions.extract && item.isExtractable()" ng-click="touch(item); item.tempModel.name=\'\'" title="{{\'extract\' | translate}}">\n        <i class="fa fa-lg fa-export"></i>\n    </button>\n    <button class="btn btn-sm btn-outline btn-icon-only dark" ng-show="config.allowedActions.download && !item.isFolder()" ng-click="item.download()" title="{{\'download\' | translate}}">\n        <i class="fa fa-lg fa-cloud-download"></i>\n    </button>\n    <button class="btn btn-sm btn-outline btn-icon-only dark" ng-show="config.allowedActions.preview && item.isImage()" ng-click="item.preview()" title="{{\'view_item\' | translate}}">\n        <i class="fa fa-lg fa-picture"></i>\n    </button>\n    <button class="btn btn-sm btn-icon-only btn-danger" data-toggle="modal" data-target="#delete" ng-show="config.allowedActions.remove" ng-click="touch(item)" title="{{\'remove\' | translate}}">\n        <i class="fa fa-lg fa-trash"></i>\n    </button>\n</div>\n<div ng-show="item.inprocess">\n    <button class="btn btn-icon-only btn-sm" style="visibility: hidden">&nbsp;</button><span class="label label-warning">{{"wait" | translate}} ...</span>\n</div>'),$templateCache.put("src/templates/main-icons.html",'<div class="iconset clearfix">\n    <div class="col-120" ng-repeat="item in fileNavigator.fileList | filter: query | orderBy: orderProp" ng-show="!fileNavigator.requesting && !fileNavigator.error">\n        <a href="" class="thumbnail text-center" ng-click="smartClick(item)" ng-right-click="touch(item)" title="{{item.model.name}} ({{item.model.sizeKb()}}kb)">\n            <div class="item-icon">\n                <i class="fa fa-folder-open" ng-show="item.model.type === \'dir\'"></i>\n                <i class="fa {{ item.model.name | fileIcon }}" ng-show="item.model.type === \'file\'"></i>\n            </div>\n            {{item.model.name | strLimit : 11 }}\n        </a>\n    </div>\n\n    <div ng-show="fileNavigator.requesting">\n        <div ng-include="config.tplPath + \'/spinner.html\'"></div>\n    </div>\n\n    <div class="alert alert-warning" ng-show="!fileNavigator.requesting && fileNavigator.fileList.length < 1 && !fileNavigator.error">\n        {{"no_files_in_folder" | translate}}...\n    </div>\n    \n    <div class="alert alert-danger" ng-show="!fileNavigator.requesting && fileNavigator.error">\n        {{ fileNavigator.error }}\n    </div>\n</div>'),$templateCache.put("src/templates/main-table-modal.html",'<table class="table table-condensed table-modal-condensed mb0">\r    <thead>\r        <tr>\r            <th class="text-right"></th>\r        </tr>\r    </thead>\r    <tbody class="file-item">\r        <tr ng-show="fileNavigator.requesting">\r            <td colspan="2">\r                <div ng-include="config.tplPath + \'/spinner.html\'"></div>\r            </td>\r        </tr>\r        <tr ng-show="!fileNavigator.requesting && !fileNavigator.listHasFolders() && !fileNavigator.error">\r            <td colspan="2">\r                {{"no_folders_in_folder" | translate}}...\r            </td>\r            <td class="text-right">\r                <button class="btn btn-sm btn-default" ng-click="fileNavigator.upDir()">{{"go_back" | translate}}</button>\r            </td>\r        </tr>\r        <tr ng-show="!fileNavigator.requesting && fileNavigator.error">\r            <td colspan="2">\r                {{ fileNavigator.error }}\r            </td>\r        </tr>\r       <tr ng-repeat="item in fileNavigator.fileList"\r          ng-show="!fileNavigator.requesting && item.model.type === \'dir\' && fileNavigator.listHasFolders()">\r            <td>\r                <a href="" ng-click="fileNavigator.folderClick(item)"\r                   title="{{item.model.name}} ({{item.model.sizeKb()}}kb)"\r                   ng-style="{\'margin-left\': ($index === 0 ? \'0%\' : \'5%\')}">\r                    <i class="fa fa-folder"></i>\r                    {{item.model.name | strLimit : 32}}\r                </a>\r            </td>\r            <td class="text-right">\r                <button class="btn btn-sm btn-default" ng-click="$root.select(item, temp)">\r                    <i class="fa fa-hand-pointer-o"></i> {{"select_this" | translate}}\r                </button>\r            </td>\r        </tr>\r        <tr ng-show="!fileNavigator.requesting && !fileNavigator.listHasFolders() && !fileNavigator.error">\r           <td colspan="2">\r               {{"no_folders_in_folder" | translate}}...\r           </td>\r           <td class="text-right">\r               <button class="btn btn-sm btn-default" ng-click="fileNavigator.upDir()">{{"go_back" | translate}}</button>\r           </td>\r       </tr>\r    </tbody>\r</table>\r'),$templateCache.put("src/templates/main-table.html",'<table class="table mb0 table-files table-striped table-bordered table-hover">\r    <thead>\r        <tr>\r           <th class="col-md-2 text-center" ng-if="!config.allowedActions.agaveUpload && !config.allowedActions.agaveSelect">\r                <input type="checkbox" ng-click="checkAll = !checkAll; checkAllFiles(checkAll);">\r                <div class="btn-group" ng-show="fileNavigator.fileListSelected.length !== 0">\r                    <a class="btn btn-outline" href="#" data-toggle="dropdown">\r                        <strong>Actions</strong>\r                        <i class="fa fa-angle-down"></i>\r                    </a>\r                    <ul class="dropdown-menu">\r                        <li ng-if="!app.available">\r                            <a ng-click="downloadFiles(fileNavigator.fileListSelected)"> <i class="fa fa-download"></i> Download </a>\r                        </li>\r                        <li>\r                            <a ng-click="deleteFiles(fileNavigator.fileListSelected)"> <i class="fa fa-trash"></i> Delete </a>\r                        </li>\r                    </ul>\r                </div>\r            </th>\r            <th class="col-md-4">\r                <a href="" ng-click="order(\'model.name\')">\r                    {{"name" | translate}}\r                    <span class="sortorder" ng-show="predicate[1] === \'model.name\'" ng-class="{reverse:reverse}"></span>\r                </a>\r            </th>\r            <th class="col-md-2 hidden-xs">\r                <a href="" ng-click="order(\'model.size\')">\r                    {{"size" | translate}}\r                    <span class="sortorder" ng-show="predicate[1] === \'model.size\'" ng-class="{reverse:reverse}"></span>\r                </a>\r            </th>\r            <th class="col-md-4 hidden-sm hidden-xs">\r                <a href="" ng-click="order(\'model.date\')">\r                    {{"date" | translate}}\r                    <span class="sortorder" ng-show="predicate[1] === \'model.date\'" ng-class="{reverse:reverse}"></span>\r                </a>\r            </th>\r            <!-- <th class="text-right" ng-if="config.allowedActions.agaveUpload && config.allowedActions.agaveSelect">Actions</th> -->\r            <th class="text-center" ng-if="config.allowedActions.agaveSelect">Select</th>\r        </tr>\r    </thead>\r    <tbody class="file-item">\r        <tr ng-show="fileNavigator.requesting">\r            <td colspan="5">\r                <div ng-include="config.tplPath + \'/spinner.html\'"></div>\r            </td>\r        </tr>\r        <tr ng-show="!fileNavigator.requesting && fileNavigator.fileList.length <= 1 && !fileNavigator.error">\r            <td colspan="5">\r                {{"no_files_in_folder" | translate}}...\r            </td>\r        </tr>\r        <tr ng-show="!fileNavigator.requesting && fileNavigator.error">\r            <td colspan="5">\r                {{ fileNavigator.error }}\r            </td>\r        </tr>\r        <tr ng-repeat="item in fileNavigator.fileList | filter: query | orderBy:predicate:reverse" ng-show="!fileNavigator.requesting && !item.model.root">\r            <td class="text-center" ng-if="!config.allowedActions.agaveUpload && !config.allowedActions.agaveSelect">\r              <label title="Download">\r                <input type="checkbox" data-checklist-model="fileNavigator.fileListSelected" data-checklist-value="item" ng-disabled="item.model.type === \'dir\'">\r              </label>\r            </td>\r            <td ng-right-click="touch(item)">\r                <a href="" ng-click="smartClick(item)" title="{{item.model.name}} ({{item.model.sizeKb()}}kb)" title="{{ item.model.name }}">\r                    <i class="fa fa-folder mr2" ng-show="item.model.type === \'dir\'"></i>\r                    <i class="fa {{ item.model.name | fileIcon }} mr2" ng-show="item.model.type === \'file\'"></i>\r                    {{item.model.name | strLimit : 64}}\r                </a>\r            </td>\r            <td class="hidden-xs">\r                {{ item.model.size | humanSize:1:true }}\r            </td>\r            <td class="hidden-sm hidden-xs" am-time-ago="item.model.date">\r\r            </td>\r            <!-- <td class="text-right" ng-if="config.allowedActions.agaveUpload && config.allowedActions.agaveSelect">\r                <div ng-include="config.tplPath + \'/item-toolbar.html\'"></div>\r            </td> -->\r            <td class="text-center" ng-if="config.allowedActions.agaveSelect">\r              <label title="select">\r                <button class="btn btn-sm btn-default" ng-click="selectItem(item)">\r                    <i class="fa fa-hand-pointer-o"></i> {{"select_this" | translate}}\r                </button>\r              </label>\r            </td>\r        </tr>\r    </tbody>\r</table>\r'),$templateCache.put("src/templates/main.html",'<div ng-controller="FileManagerCtrl" ngf-drop="addForUpload($files)" ngf-drag-over-class="\'upload-dragover\'" ngf-multiple="true" class="browser-container" ng-class="{\'container\': (config.layout == \'boxed\')}">\r    <div ng-include="config.tplPath + \'/navbar.html\'" class="browser-title"></div>\r\r    <div class="container-fluid browser-body">\r        <div class="row">\r            <div class="main" ng-class="config.sidebar && fileNavigator.history[0]">\r                <div ng-include="config.tplPath + \'/current-folder-breadcrumb.html\'" ng-show="config.breadcrumb"></div>\r                <div ng-include="config.tplPath + \'/\' + viewTemplate" class="main-navigation clearfix"></div>\r            </div>\r        </div>\r    </div>\r\r    <div ng-include="config.tplPath + \'/modals.html\'"></div>\r    <div ng-include="config.tplPath + \'/item-context-menu.html\'"></div>\r</div>\r'),$templateCache.put("src/templates/modals.html",'<div class="modal animated fadeIn" id="delete">\n  <div class="modal-dialog">\n    <div class="modal-content">\n    <form ng-submit="remove(temp)">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal">\n            <span aria-hidden="true">&times;</span>\n            <span class="sr-only">{{"close" | translate}}</span>\n        </button>\n        <h4 class="modal-title">{{"confirm" | translate}}</h4>\n      </div>\n      <div class="modal-body">\n        {{\'sure_to_delete\' | translate}} <b>{{temp.model.name}}</b> ?\n        <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"cancel" | translate}}</button>\n        <button type="submit" class="btn btn-primary" ng-disabled="temp.inprocess" autofocus="autofocus">{{"remove" | translate}}</button>\n      </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="rename">\n  <div class="modal-dialog">\n    <div class="modal-content">\n        <form ng-submit="rename(temp)">\n            <div class="modal-header">\n              <button type="button" class="close" data-dismiss="modal">\n                  <span aria-hidden="true">&times;</span>\n                  <span class="sr-only">{{"close" | translate}}</span>\n              </button>\n              <h4 class="modal-title">{{\'change_name_move\' | translate}}</h4>\n            </div>\n            <div class="modal-body">\n              <label class="radio">{{\'enter_new_name_for\' | translate}} <b>{{temp.model.name}}</b></label>\n              <input class="form-control" ng-model="temp.tempModel.name" autofocus="autofocus">\n\n              <div ng-include data-src="\'path-selector\'" class="clearfix"></div>\n              <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"cancel" | translate}}</button>\n              <button type="submit" class="btn btn-primary" ng-disabled="temp.inprocess">{{\'rename\' | translate}}</button>\n            </div>\n        </form>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="preview">\n  <div class="modal-dialog modal-lg">\n    <div class="modal-content">\n            <div class="modal-header">\n              <button type="button" class="close" data-dismiss="modal">\n                  <span aria-hidden="true">&times;</span>\n                  <span class="sr-only">{{"close" | translate}}</span>\n              </button>\n              <h4 class="modal-title" ng-show="!temp.tempModel.preview.isEdit"><span ng-show="temp.tempModel.preview.isPreviewable">{{\'previewing\' | translate}}</span> <b>{{temp.model.name}}</b></h4>\n              <h4 class="modal-title" ng-show="temp.tempModel.preview.isEdit">{{\'editing\' | translate}} <b>{{temp.model.name}}</b></h4>\n            </div>\n             <div class="modal-body">\n              <div class="container-fluid">\n                <div class="row">\n                  <div ng-show="temp.inprocess">\n                    <div ng-include="config.tplPath + \'/spinner.html\'"></div>\n                  </div>\n                  <div ng-show="!temp.inprocess && temp.tempModel.preview.isPreviewable">\n                    <div ng-if="temp.tempModel.preview.isPdf">\n                        <object data = "{{temp.tempModel.preview.data}}" width="100%" height="600">\n                        </object>\n                    </div>\n                    <div ng-if="temp.tempModel.preview.isImage" class="text-center">\n                        <img ng-src= "{{temp.tempModel.preview.url}}" class="img-responsive"/>\n                    </div>\n                    <div ng-if="temp.tempModel.preview.isText" class="text-center">\n                        <object data= "{{temp.tempModel.preview.data}}" onload="window.URL.revokeObjectURL(this.data);" width="100%" height="500px">\n                        </object>\n                    </div>\n                    <div ng-if="temp.tempModel.preview.isEdit">\n                      <label class="radio">\n                          {{\'file_content\' | translate}}\n                          <select class="form-input pull-right input-large editorSyntaxSelector clear" ng-model="cmMode" ng-options="m for m in modes" ng-change="modeChanged()"></select>\n                      </label>\n                      <textarea class="" ui-codemirror ui-codemirror-opts="cmOptions" ng-model="temp.tempModel.content" ng-show="!temp.inprocess" autofocus="autofocus" ui-refresh="temp.inprocess"></textarea>\n                    </div>\n                  </div>\n                  <div  ng-include data-src="\'error-bar\'"></div>\n                </div>\n                <div class="row text-center" ng-show="!temp.inprocess && !temp.tempModel.preview.isPreviewable">\n                  <span><i class="fa fa-5x fa-file-o"></i></span>\n                </div>\n              </div>\n            </div>\n            <div class="modal-footer">\n              <div class="col-lg-12 text-center" ng-show="!temp.inprocess">\n                <button type="button" class="btn btn-success text-center" ng-show="!temp.tempModel.preview.isEdit" ng-disabled="temp.inprocess" ng-click="download(temp)"><i class="fa fa-download"></i> {{"download" | translate}}</button>\n                <button type="button" class="btn btn-success text-center" ng-show="temp.tempModel.preview.isEdit" ng-disabled="temp.inprocess" ng-click="editSave(temp)"><i class="fa fa-floppy-o"></i> {{"save" | translate}}</button>\n                <button type="button" class="btn btn-primary text-center" ng-show="temp.tempModel.preview.isText && temp.tempModel.preview.isPreviewable" ng-disabled="temp.inprocess" ng-click="temp.getContent();temp.tempModel.preview.isEdit = true; temp.tempModel.preview.isText = false;"><i class="fa fa-pencil"></i>{{"edit" | translate}}</button>\n                <button type="button" class="btn btn-default tex-center" data-dismiss="modal" ng-disabled="temp.inprocess">{{"close" | translate}}</button>\n              </div>\n            </div>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="postit">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <form ng-submit="createPostit(temp)">\n                <div class="modal-header">\n                    <!-- temp-{{temp}} -->\n                    <button type="button" class="close" data-dismiss="modal">\n                        <span aria-hidden="true">&times;</span>\n                        <span class="sr-only">{{"close" | translate}}</span>\n                    </button>\n                    <h4 class="modal-title">Create PostIt</h4>\n                </div>\n                <div class="modal-body">\n                    <label class="radio">Number of uses </label>\n                    <input type="number" min="1" class="form-control" ng-model="temp.postit.maxUses" autofocus="autofocus">\n\n                    <label class="radio">Lifetime</label>\n                    <div class="input-group">\n                     <input ng-model="temp.postit.lifetime" class="form-control" type="number">\n                     <div class="input-group-btn">\n                       <div class="dropdown">\n                         <button class="btn btn-default dropdown-toggle" type="button" id="menu1" data-toggle="dropdown"><span class="caret"></span> {{timeItem}}</button>\n                         <ul class="dropdown-menu">\n                           <li ng-repeat="timeItem in timeItems">\n                             <a href="#" ng-click="selectTime(timeItem)">{{timeItem}}</a>\n                           </li>\n                         </ul>\n                       </div>\n                     </div>\n                   </div>\n                    <div class="panel panel-primary mt10 mb0">\n                        <div class="panel-body">\n                            <div class="detail-sources">\n                                <code class="mr5"><b>{{"source" | translate}}:</b> {{temp.tempModel._links.self.href}}</code>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="panel panel-primary mt10 mb0 text-center" ng-show="temp.postit.link">\n                        <div class="panel-body">\n                          <div class="detail-sources">\n                              <code><a ng-href="{{temp.postit.link}}" target="_blank" class="mr5"> {{temp.postit.link}}</a></code>\n                              <a href="#" ngclipboard data-clipboard-text="{{temp.postit.link}}" title="Copy to clipboard"><i class="fa fa-copy"></i></a>\n                          </div>\n\n                        </div>\n                    </div>\n                    <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n                </div>\n                <div class="modal-footer">\n                    <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"cancel" | translate}}</button>\n                    <button type="submit" class="btn btn-primary" ng-disabled="temp.inprocess">{{\'Create\' | translate}}</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>\n\n<div class="modal animated fadeIn" id="copy">\n  <div class="modal-dialog modal-lg">\n    <div class="modal-content">\n        <form ng-submit="copy(temp)">\n            <div class="modal-header">\n              <button type="button" class="close" data-dismiss="modal">\n                  <span aria-hidden="true">&times;</span>\n                  <span class="sr-only">{{"close" | translate}}</span>\n              </button>\n              <h4 class="modal-title">{{\'copy_file\' | translate}}</h4>\n            </div>\n            <div class="modal-body">\n              <p>Change Destination System: {{temp.tempModel.system.id}}</p>\n              <system-select agave-source-system="temp.tempModel.system" agave-dest-system="selectedSystem" search-filter="\'\'"></system-select>\n              <label class="radio">{{\'enter_new_name_for\' | translate}} <b>{{temp.model.name}}</b></label>\n              <input class="form-control" ng-model="temp.tempModel.name" autofocus="autofocus">\n              <div class="panel panel-primary mt10 mb0">\n                <div class="panel-body">\n                    <div class="detail-sources">\n                      <code class="mr5"><b>{{"source" | translate}}:</b> {{temp.tempModel.system.id}}/{{temp.model.fullPath()}}</code>\n                    </div>\n                    <div class="detail-sources">\n                      <code class="mr5">\n                        <b>{{"destination" | translate}}:</b>\n                        <span ng-show="selectedSystem"> {{selectedSystem.id}}/{{temp.tempModel.fullPath()}}</span>\n                        <!--<span ng-show="selectedSystem"> {{selectedSystem.id}}/{{temp.tempModel.fullPath()}}</span>-->\n                        <!--<span ng-show="!selectedSystem"> {{temp.tempModel.system.id}}/{{temp.tempModel.fullPath()}}</span>-->\n                      </code>\n                      <a href="" class="btn btn-primary" role="button" ng-click="$root.openNavigator(temp, selectedSystem)">{{\'change\' | translate}}</a>\n                    </div>\n                </div>\n              </div>\n              <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"cancel" | translate}}</button>\n              <button type="submit" class="btn btn-primary" ng-disabled="temp.inprocess">Copy</button>\n            </div>\n        </form>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="compress">\n  <div class="modal-dialog">\n    <div class="modal-content">\n        <form ng-submit="compress(temp)">\n            <div class="modal-header">\n              <button type="button" class="close" data-dismiss="modal">\n                  <span aria-hidden="true">&times;</span>\n                  <span class="sr-only">{{"close" | translate}}</span>\n              </button>\n              <h4 class="modal-title">{{\'compress\' | translate}}</h4>\n            </div>\n            <div class="modal-body">\n              <div ng-show="temp.asyncSuccess">\n                  <div class="label label-success error-msg">{{\'compression_started\' | translate}}</div>\n              </div>\n              <div ng-hide="temp.asyncSuccess">\n                  <div ng-hide="config.allowedActions.compressChooseName">\n                    {{\'sure_to_start_compression_with\' | translate}} <b>{{temp.model.name}}</b> ?\n                  </div>\n                  <div ng-show="config.allowedActions.compressChooseName">\n                    <label class="radio">{{\'enter_folder_name_for_compression\' | translate}} <b>{{fileNavigator.currentPath.join(\'/\')}}/{{temp.model.name}}</b></label>\n                    <input class="form-control" ng-model="temp.tempModel.name" autofocus="autofocus">\n                  </div>\n              </div>\n\n              <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n            </div>\n            <div class="modal-footer">\n              <div ng-show="temp.asyncSuccess">\n                  <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"close" | translate}}</button>\n              </div>\n              <div ng-hide="temp.asyncSuccess">\n                  <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"cancel" | translate}}</button>\n                  <button type="submit" class="btn btn-primary" ng-disabled="temp.inprocess">{{\'compress\' | translate}}</button>\n              </div>\n            </div>\n        </form>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="extract" ng-init="temp.emptyName()">\n  <div class="modal-dialog">\n    <div class="modal-content">\n        <form ng-submit="extract(temp)">\n            <div class="modal-header">\n              <button type="button" class="close" data-dismiss="modal">\n                  <span aria-hidden="true">&times;</span>\n                  <span class="sr-only">{{"close" | translate}}</span>\n              </button>\n              <h4 class="modal-title">{{\'extract_item\' | translate}}</h4>\n            </div>\n            <div class="modal-body">\n              <div ng-show="temp.asyncSuccess">\n                  <div class="label label-success error-msg">{{\'extraction_started\' | translate}}</div>\n              </div>\n              <div ng-hide="temp.asyncSuccess">\n                  <label class="radio">{{\'enter_folder_name_for_extraction\' | translate}} <b>{{temp.model.name}}</b></label>\n                  <input class="form-control" ng-model="temp.tempModel.name" autofocus="autofocus">\n                  <div ng-include data-src="\'path-selector\'" class="clearfix"></div>\n              </div>\n              <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n            </div>\n            <div class="modal-footer">\n              <div ng-show="temp.asyncSuccess">\n                  <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"close" | translate}}</button>\n              </div>\n              <div ng-hide="temp.asyncSuccess">\n                  <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"cancel" | translate}}</button>\n                  <button type="submit" class="btn btn-primary" ng-disabled="temp.inprocess">{{\'extract\' | translate}}</button>\n              </div>\n            </div>\n        </form>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="edit" ng-class="{\'modal-fullscreen\': fullscreen}">\n  <div class="modal-dialog modal-lg">\n    <div class="modal-content">\n        <form ng-submit="edit(temp)">\n            <div class="modal-header">\n              <button type="button" class="close" data-dismiss="modal">\n                  <span aria-hidden="true">&times;</span>\n                  <span class="sr-only">{{"close" | translate}}</span>\n              </button>\n              <button type="button" class="btn btn-default btn-xs pull-right btn-outline mrm fullscreen" ng-click="fullscreen=!fullscreen">\n                  <span aria-hidden="true" class="fa fa-{{ fullscreen ? \'compress\' : \'expand\' }}"></span>\n                  <span class="sr-only">{{\'toggle_fullscreen\' | translate}}</span>\n              </button>\n              <h4 class="modal-title">{{\'edit_file\' | translate}}</h4>\n            </div>\n            <div class="modal-body">\n\n                <label class="radio">\n                    {{\'file_content\' | translate}}\n                    <select class="form-input pull-right input-large editorSyntaxSelector clear" ng-model="cmMode" ng-options="m for m in modes" ng-change="modeChanged()"></select>\n                </label>\n\n                <span class="label label-warning" ng-show="temp.inprocess">{{\'loading\' | translate}} ...</span>\n                <textarea class="" ui-codemirror ui-codemirror-opts="cmOptions" ng-model="temp.tempModel.content" ng-show="!temp.inprocess" autofocus="autofocus" ui-refresh="temp.inprocess"></textarea>\n                <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"cancel" | translate}}</button>\n              <button type="submit" class="btn btn-primary" ng-disabled="temp.inprocess">{{\'Save\' | translate}}</button>\n            </div>\n        </form>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="newfolder">\n  <div class="modal-dialog">\n    <div class="modal-content">\n        <form ng-submit="createFolder(temp)">\n            <div class="modal-header">\n              <button type="button" class="close" data-dismiss="modal">\n                  <span aria-hidden="true">&times;</span>\n                  <span class="sr-only">{{"close" | translate}}</span>\n              </button>\n              <h4 class="modal-title">{{\'create_folder\' | translate}}</h4>\n            </div>\n            <div class="modal-body">\n              <label class="radio">{{\'folder_name\' | translate}}</label>\n              <input class="form-control" ng-model="temp.tempModel.name" autofocus="autofocus">\n              <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"cancel" | translate}}</button>\n              <button type="submit" class="btn btn-primary" ng-disabled="temp.inprocess">{{\'create\' | translate}}</button>\n            </div>\n        </form>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="uploadfile">\n  <div class="modal-dialog">\n    <div class="modal-content">\n        <form ng-submit="uploadFiles()">\n            <div class="modal-header">\n              <button type="button" class="close" data-dismiss="modal">\n                  <span aria-hidden="true">&times;</span>\n                  <span class="sr-only">{{"close" | translate}}</span>\n              </button>\n              <h4 class="modal-title">{{"upload_files" | translate}}</h4>\n            </div>\n            <div class="modal-body">\n              <label class="radio">\n                {{"files_will_uploaded_to" | translate}}\n                <b>/{{fileNavigator.currentPath.join(\'/\')}}</b>\n              </label>\n\n              <div  ngf-drop="$parent.addForUpload($files)"\n                    ngf-select="$parent.addForUpload($files)"\n                    class="drop-box"\n                    ngf-drag-over-class="\'dragover\'"\n                    ngf-include-dir="true"\n                    ngf-multiple="true">Drop files here or click to upload</div>\n              <div ngf-no-file-drop>File Drag/Drop is not supported for this browser</div>\n\n              <div class="checkbox" ng-if="$parent.uploadFileList | hasDirectories" >\n                  <label for="preserve-directory-structure">\n                  <input id="preserve-directory-structure" ng-model="preserveDirectoryStructure" type="checkbox" class="switch" name="preserve-directory-structure"> Preserve the original directory structure?</label>\n              </div>\n              <div class="upload-list">\n                <ul class="list-group">\n                  <li class="list-group-item" ng-repeat="(index, uploadFile) in $parent.uploadFileList">\n                    <button ng-if="uploadFile.type != \'dir\'" class="btn btn-sm btn-danger pull-right" ng-click="$parent.removeFromUpload(index)">\n                        &times;\n                    </button>\n                    <h5 class="list-group-item-heading">{{uploadFile.name}}</h5>\n                    <p class="list-group-item-text">{{uploadFile.size | humanReadableFileSize}}</p>\n                    <div ng-show="fileUploader.requesting">\n                      <em>{{"uploading" | translate}}... {{uploadFile.progress}}%</em>\n                      <div class="progress mb0">\n                        <div class="progress-bar active" role="progressbar" aria-valuenow="{{uploadFile.progress}}" aria-valuemin="0" aria-valuemax="100" style="width: {{uploadFile.progress}}%"></div>\n                      </div>\n                    </div>\n                  </li>\n                </ul>\n              </div>\n              <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n            </div>\n            <div class="modal-footer">\n              <div ng-show="!fileUploader.requesting">\n                  <button type="button" class="btn btn-default" data-dismiss="modal">{{"cancel" | translate}}</button>\n                  <button type="submit" class="btn btn-primary" ng-disabled="!uploadFileList.length || fileUploader.requesting">{{\'upload\' | translate}}</button>\n              </div>\n            </div>\n        </form>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="changepermissions">\n  <div class="modal-dialog modal-lg">\n    <div class="modal-content">\n      <form ng-submit="changePermissions(temp)">\n        <div class="modal-header">\n          <button type="button" class="close" data-dismiss="modal">\n              <span aria-hidden="true">&times;</span>\n              <span class="sr-only">{{"close" | translate}}</span>\n          </button>\n          <h4 class="modal-title">{{\'change_permissions\' | translate}}</h4>\n        </div>\n        <div class="modal-body">\n          <div class="row" ng-show="temp.inprocess">\n            <div ng-include="config.tplPath + \'/spinner.html\'"></div>\n          </div>\n          <div class="row" ng-show="!temp.inprocess">\n            <div class="col-md-6 text-center">\n              <span class="label label-primary">{{\'original\' | translate}}</span>\n              <div class="table-responsive">\n                <table class="table">\n                <thead>\n                  <tr>\n                    <th class="col-xs-1 text-center">{{\'user\' | translate}}</th>\n                    <th class="col-xs-1 text-center">{{\'execute\' | translate}}</th>\n                    <th class="col-xs-1 text-center">{{\'read\' | translate}}</th>\n                    <th class="col-xs-1 text-center">{{\'write\' | translate}}</th>\n                    <th class="col-xs-1 text-center" ng-if="temp.model.type === \'dir\'">{{\'recursive\' | translate}}</th>\n                  </tr>\n                </thead>\n                  <tbody>\n                  <tr ng-repeat="(permTypeKey, permTypeValue) in temp.model.perms">\n                    <td>\n                    {{permTypeKey | translate}}\n                    </td>\n                    <td class="col-xs-1">\n                    <label class="col-xs-12">\n                      <input type="checkbox" ng-model="temp.model.perms[permTypeKey][\'execute\']" ng-checked="temp.model.perms[permTypeKey][\'execute\']" disabled>\n                    </label>\n                    </td>\n                    <td class="col-xs-1">\n                      <label class="col-xs-12">\n                      <input type="checkbox" ng-model="temp.model.perms[permTypeKey][\'read\']" ng-checked="temp.model.perms[permTypeKey][\'read\']" disabled>\n                      </label>\n                    </td>\n                    <td class="col-xs-1">\n                      <label class="col-xs-12">\n                      <input type="checkbox" ng-model="temp.model.perms[permTypeKey][\'write\']" ng-checked="temp.model.perms[permTypeKey][\'write\']" disabled>\n                      </label>\n                    </td>\n                    <td class="col-xs-1" ng-if="temp.model.type === \'dir\'">\n                      <label class="col-xs-12">\n                      <input type="checkbox" ng-model="temp.model.perms[permTypeKey][\'recursive\']" ng-checked="temp.model.perms[permTypeKey][\'recursive\']" disabled>\n                      </label>\n                    </td>\n                  </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n            <div class="col-md-6 text-center">\n              <span class="label label-primary text-center">{{\'changes\' | translate}}</span>\n              <div class="table-responsive">\n                <table class="table">\n                  <thead>\n                    <tr>\n                      <th class="col-xs-1 text-center">{{\'user\' | translate}}</th>\n                      <th class="col-xs-1 text-center">{{\'execute\' | translate}}</th>\n                      <th class="col-xs-1 text-center">{{\'read\' | translate}}</th>\n                      <th class="col-xs-1 text-center">{{\'write\' | translate}}</th>\n                      <th class="col-xs-1 text-center" ng-if="temp.tempModel.type === \'dir\'">{{\'recursive\' | translate}}</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr ng-repeat="(permTypeKey, permTypeValue) in temp.tempModel.perms">\n                      <td>\n                      {{permTypeKey | translate}}\n                      </td>\n                      <td class="col-xs-1">\n                        <label class="col-xs-12">\n                        <input type="checkbox" ng-model="temp.tempModel.perms[permTypeKey][\'execute\']" ng-checked="temp.tempModel.perms[permTypeKey][\'execute\']">\n                        </label>\n                      </td>\n                      <td class="col-xs-1">\n                        <label class="col-xs-12">\n                        <input type="checkbox" ng-model="temp.tempModel.perms[permTypeKey][\'read\']" ng-checked="temp.tempModel.perms[permTypeKey][\'read\']">\n                        </label>\n                      </td>\n                      <td class="col-xs-1">\n                        <label class="col-xs-12">\n                        <input type="checkbox" ng-model="temp.tempModel.perms[permTypeKey][\'write\']" ng-checked="temp.tempModel.perms[permTypeKey][\'write\']">\n                        </label>\n                      </td>\n                      <td class="col-xs-1" ng-if="temp.model.type === \'dir\'">\n                        <label class="col-xs-12">\n                        <input type="checkbox" ng-model="temp.tempModel.perms[permTypeKey][\'recursive\']" ng-checked="temp.tempModel.perms[permTypeKey][\'recursive\']">\n                        </label>\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n          <div ng-include data-src="\'error-bar\'" class="clearfix"></div>\n        </div>\n        <div class="modal-footer">\n          <button type="button" class="btn btn-default" data-dismiss="modal">{{"cancel" | translate}}</button>\n          <button type="submit" class="btn btn-primary" ng-disabled="">{{\'change\' | translate}}</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n\n<div class="modal animated fadeIn" id="selector" ng-controller="ModalFileManagerCtrl">\n  <div class="modal-dialog">\n    <div class="modal-content">\n      <div class="modal-header">\n        <button type="button" class="close" data-dismiss="modal">\n            <span aria-hidden="true">&times;</span>\n            <span class="sr-only">{{"close" | translate}}</span>\n        </button>\n        <h4 class="modal-title">{{"select_destination_folder" | translate}}</h4>\n      </div>\n      <div class="modal-body">\n        <div>\n            <div ng-include="config.tplPath + \'/current-folder-breadcrumb.html\'"></div>\n            <div ng-include="config.tplPath + \'/main-table-modal.html\'"></div>\n        </div>\n      </div>\n      <div class="modal-footer">\n        <button type="button" class="btn btn-default" data-dismiss="modal" ng-disabled="temp.inprocess">{{"close" | translate}}</button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<script type="text/ng-template" id="path-selector">\n  <div class="panel panel-primary mt10 mb0">\n    <div class="panel-body">\n        <div class="detail-sources">\n          <code class="mr5"><b>{{"source" | translate}}:</b> {{temp.model.fullPath()}}</code>\n        </div>\n        <div class="detail-sources">\n          <code class="mr5"><b>{{"destination" | translate}}:</b>{{temp.tempModel.fullPath()}}</code>\n          <a href="" class="label label-primary" ng-click="$root.openNavigator(temp)">{{\'change\' | translate}}</a>\n        </div>\n    </div>\n  </div>\n</script>\n<script type="text/ng-template" id="error-bar">\n    <div class="label label-danger error-msg pull-left animated fadeIn" ng-show="temp.error">\n      <i class="glyphicon glyphicon-remove-circle"></i>\n      <span>{{temp.error}}</span>\n    </div>\n</script>\n\n<script type="text/ng-template" id="publish-bar">\n    <div class="panel panel-primary mt10 mb0">\n        <div class="panel-body">\n            <div class="detail-sources">\n                <code class="mr5"><b>original:</b> {{temp.tempModel._links.self.href}}</code>\n            </div>\n            <div class="detail-sources">\n                <code class="mr5"><b>public:</b>{{temp.tempModel.publicUrl()}}</code>\n            </div>\n        </div>\n    </div>\n</script>\n'),
$templateCache.put("src/templates/navbar.html",'\r  <div class="caption">\r    <i class="fa fa-server"></i> {{ system.name }} : {{ fileNavigator.currentPath.join(\'/\') || \'/\' }} </div>\r  <div class="actions">\r    <input type="text" class="form-control hide" placeholder="{{\'search\' | translate}}..." ng-model="$parent.query">\r    <button class="btn btn-outline red" data-toggle="modal" data-target="#newfolder" ng-click="touch()" ng-hide="upload">\r      <i class="fa fa-plus"></i> {{"create_folder" | translate}}\r    </button>\r    <button class="btn btn-outline green" data-toggle="modal" data-target="#uploadfile" ng-click="touch()" ng-hide="upload">\r      <i class="fa fa-upload"></i> {{"upload_file" | translate}}\r    </button>\r    <!-- <button class="btn btn-outline dark dropdown-toggle" type="button" id="dropDownMenuLang" data-toggle="dropdown" aria-expanded="true" ng-hide="upload">\r      <i class="fa fa-globe"></i> {{"language" | translate}} <span class="caret"></span>\r    </button>\r    <ul class="dropdown-menu" role="menu" aria-labelledby="dropDownMenuLang" ng-hide="upload">\r      <li role="presentation"><a role="menuitem" tabindex="-1" href="" ng-click="changeLanguage(\'en\')">{{"english" | translate}}</a></li>\r      <li role="presentation"><a role="menuitem" tabindex="-1" href="" ng-click="changeLanguage(\'es\')">{{"spanish" | translate}}</a></li>\r      <li role="presentation"><a role="menuitem" tabindex="-1" href="" ng-click="changeLanguage(\'pt\')">{{"portuguese" | translate}}</a></li>\r      <li role="presentation"><a role="menuitem" tabindex="-1" href="" ng-click="changeLanguage(\'fr\')">{{"french" | translate}}</a></li>\r    </ul> -->\r\r    <button class="btn btn-outline dark" ng-click="fileNavigator.refresh()" title="{{\'refresh\' | translate}}">\r      <i class="fa fa-refresh"></i>\r    </button>\r    <button class="btn btn-outline dark" ng-click="$parent.setTemplate(\'main-icons.html\')" ng-show="$parent.viewTemplate !== \'main-icons.html\'" title="{{\'icons\' | translate}}">\r      <i class="fa fa-th-large"></i>\r    </button>\r    <button class="btn btn-outline dark" ng-click="$parent.setTemplate(\'main-table.html\')" ng-show="$parent.viewTemplate !== \'main-table.html\'" title="{{\'list\' | translate}}">\r      <i class="fa fa-th-list"></i>\r    </button>\r  </div>\r\r\r<!--<nav class="navbar navbar-inverse navbar-fixed-top">-->\r  <!--<div class="container-fluid">-->\r    <!--<div class="navbar-header">-->\r      <!--<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">-->\r        <!--<span class="sr-only">Toggle</span>-->\r        <!--<span class="icon-bar"></span>-->\r        <!--<span class="icon-bar"></span>-->\r        <!--<span class="icon-bar"></span>-->\r      <!--</button>-->\r      <!--<a class="navbar-brand hidden-xs" href="" ng-click="fileNavigator.goTo(-1)">{{appName}}</a>-->\r    <!--</div>-->\r    <!--<div id="navbar" class="navbar-collapse collapse">-->\r      <!--<div class="navbar-form navbar-right">-->\r        <!--<input type="text" class="form-control input-sm hide" placeholder="{{\'search\' | translate}}..." ng-model="$parent.query">-->\r        <!--<button class="btn btn-default btn-sm" data-toggle="modal" data-target="#newfolder" ng-click="touch()">-->\r            <!--<i class="fa fa-plus"></i> {{"create_folder" | translate}}-->\r        <!--</button>-->\r        <!--<button class="btn btn-default btn-sm" data-toggle="modal" data-target="#uploadfile" ng-click="touch()">-->\r            <!--<i class="fa fa-upload"></i> {{"upload_file" | translate}}-->\r        <!--</button>-->\r\r        <!--<button class="btn btn-default btn-sm dropdown-toggle" type="button" id="dropDownMenuLang" data-toggle="dropdown" aria-expanded="true">-->\r            <!--<i class="fa fa-globe"></i> {{"language" | translate}} <span class="caret"></span>-->\r        <!--</button>-->\r        <!--<ul class="dropdown-menu" role="menu" aria-labelledby="dropDownMenuLang">-->\r          <!--<li role="presentation"><a role="menuitem" tabindex="-1" href="" ng-click="changeLanguage(\'en\')">{{"english" | translate}}</a></li>-->\r          <!--<li role="presentation"><a role="menuitem" tabindex="-1" href="" ng-click="changeLanguage(\'es\')">{{"spanish" | translate}}</a></li>-->\r          <!--<li role="presentation"><a role="menuitem" tabindex="-1" href="" ng-click="changeLanguage(\'pt\')">{{"portuguese" | translate}}</a></li>-->\r          <!--<li role="presentation"><a role="menuitem" tabindex="-1" href="" ng-click="changeLanguage(\'fr\')">{{"french" | translate}}</a></li>-->\r        <!--</ul>-->\r\r        <!--<button class="btn btn-default btn-sm" ng-click="$parent.setTemplate(\'main-icons.html\')" ng-show="$parent.viewTemplate !== \'main-icons.html\'" title="{{\'icons\' | translate}}">-->\r            <!--<i class="fa fa-th-large"></i>-->\r        <!--</button>-->\r        <!--<button class="btn btn-default btn-sm" ng-click="$parent.setTemplate(\'main-table.html\')" ng-show="$parent.viewTemplate !== \'main-table.html\'" title="{{\'list\' | translate}}">-->\r            <!--<i class="fa fa-th-list"></i>-->\r        <!--</button>-->\r\r      <!--</div>-->\r    <!--</div>-->\r  <!--</div>-->\r<!--</nav>-->\r'),$templateCache.put("src/templates/permissions.html",'<div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>\n    <h4 class="modal-title">Permissions</h4>\n</div>\n<div class="modal-body">\n  <p>\n    The current permissions are listed below. You may add, updated, or delete them as needed.\n    If you\'re the file owner or tenant admin, permissions will not be updated on your username.\n  </p>\n  <div class="row text-center" ng-show="requesting">\n      <div class="col-md-12">\n        <div class="loading-message"><div class="block-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>\n      </div>\n  </div>\n  <div class="row" ng-if="!requesting">\n      <div class="col-md-12">\n        <form\n              sf-schema="schema"\n              sf-form="form"\n              sf-model="tempModel"\n              >\n        </form>\n      </div>\n  </div>\n</div>\n<div class="modal-footer">\n    <button class="btn dark btn-outline" ng-click="cancel()">Cancel</button>\n    <button class="btn btn-primary" ng-click="savePermissionChanges()">Save changes</button>\n</div>\n'),$templateCache.put("src/templates/sidebar.html",'<ul class="nav nav-sidebar file-tree-root">\n    <li ng-repeat="item in fileNavigator.history" ng-include="\'folder-branch-item\'" ng-class="{\'active\': item.name == fileNavigator.currentPath.join(\'/\')}"></li>\n</ul>\n\n<script type="text/ng-template" id="folder-branch-item">\n    <a href="" ng-click="fileNavigator.sidebarFolderClick(item)" class="animated fast fadeInDown" title="{{ (item.name.split(\'/\').pop() || \'/\') }}">\n        <i class="fa fa-folder mr2" ng-hide="isInThisPath(item.name)"></i>\n        <i class="fa fa-folder-open mr2"  ng-show="isInThisPath(item.name)"></i>\n        {{ (item.name.split(\'/\').pop() || \'/\') | strLimit : 14 }}\n    </a>\n    <ul class="nav nav-sidebar">\n        <li ng-repeat="item in item.nodes" ng-include="\'folder-branch-item\'" ng-class="{\'active\': item.name == fileNavigator.currentPath.join(\'/\')}"></li>\n    </ul>\n</script>\n'),$templateCache.put("src/templates/spinner.html",'<div class="spinner-container col-xs-12">\n    <svg class="spinner" width="65px" height="65px" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">\n       <circle class="path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle>\n    </svg>\n</div>')}]);